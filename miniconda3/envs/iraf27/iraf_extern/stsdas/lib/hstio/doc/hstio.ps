%!PS-Adobe-2.0
%%Creator: dvips 5.58 Copyright 1986, 1994 Radical Eye Software
%%Title: hstio.dvi
%%CreationDate: Wed Aug 21 10:27:24 1996
%%Pages: 21
%%PageOrder: Ascend
%%BoundingBox: 0 0 612 792
%%DocumentFonts: Times-Roman Times-Bold Courier
%%EndComments
%DVIPSCommandLine: dvips hstio
%DVIPSParameters: dpi=300, comments removed
%DVIPSSource:  TeX output 1996.08.21:1027
%%BeginProcSet: tex.pro
/TeXDict 250 dict def TeXDict begin /N{def}def /B{bind def}N /S{exch}N
/X{S N}B /TR{translate}N /isls false N /vsize 11 72 mul N /hsize 8.5 72
mul N /landplus90{false}def /fixcurrentmatrix{statusdict /product known{
statusdict /product get(LaserJet 4)eq{/version where{/version get
(2011.110)eq{matrix currentmatrix dup dup 0 get 32768 mul round 32768
div 0 exch put dup dup 3 get 32768 mul round 32768 div 3 exch put
systemdict /setmatrix get exec}if}if}if}if}B /setmatrix{systemdict
/setmatrix get exec fixcurrentmatrix}B /@rigin{isls{[0 landplus90{1 -1}{
-1 1}ifelse 0 0 0]concat}if 72 Resolution div 72 VResolution div neg
scale isls{landplus90{VResolution 72 div vsize mul 0 exch}{Resolution
-72 div hsize mul 0}ifelse TR}if Resolution VResolution vsize -72 div 1
add mul TR[matrix currentmatrix{dup dup round sub abs 0.00001 lt{round}
if}forall round exch round exch]setmatrix}N /@landscape{/isls true N}B
/@manualfeed{statusdict /manualfeed true put}B /@copies{/#copies X}B
/FMat[1 0 0 -1 0 0]N /FBB[0 0 0 0]N /nn 0 N /IE 0 N /ctr 0 N /df-tail{
/nn 8 dict N nn begin /FontType 3 N /FontMatrix fntrx N /FontBBox FBB N
string /base X array /BitMaps X /BuildChar{CharBuilder}N /Encoding IE N
end dup{/foo setfont}2 array copy cvx N load 0 nn put /ctr 0 N[}B /df{
/sf 1 N /fntrx FMat N df-tail}B /dfs{div /sf X /fntrx[sf 0 0 sf neg 0 0]
N df-tail}B /E{pop nn dup definefont setfont}B /ch-width{ch-data dup
length 5 sub get}B /ch-height{ch-data dup length 4 sub get}B /ch-xoff{
128 ch-data dup length 3 sub get sub}B /ch-yoff{ch-data dup length 2 sub
get 127 sub}B /ch-dx{ch-data dup length 1 sub get}B /ch-image{ch-data
dup type /stringtype ne{ctr get /ctr ctr 1 add N}if}B /id 0 N /rw 0 N
/rc 0 N /gp 0 N /cp 0 N /G 0 N /sf 0 N /CharBuilder{save 3 1 roll S dup
/base get 2 index get S /BitMaps get S get /ch-data X pop /ctr 0 N ch-dx
0 ch-xoff ch-yoff ch-height sub ch-xoff ch-width add ch-yoff
setcachedevice ch-width ch-height true[1 0 0 -1 -.1 ch-xoff sub ch-yoff
.1 sub]{ch-image}imagemask restore}B /D{/cc X dup type /stringtype ne{]}
if nn /base get cc ctr put nn /BitMaps get S ctr S sf 1 ne{dup dup
length 1 sub dup 2 index S get sf div put}if put /ctr ctr 1 add N}B /I{
cc 1 add D}B /bop{userdict /bop-hook known{bop-hook}if /SI save N @rigin
0 0 moveto /V matrix currentmatrix dup 1 get dup mul exch 0 get dup mul
add .99 lt{/QV}{/RV}ifelse load def pop pop}N /eop{SI restore userdict
/eop-hook known{eop-hook}if showpage}N /@start{userdict /start-hook
known{start-hook}if pop /VResolution X /Resolution X 1000 div /DVImag X
/IE 256 array N 0 1 255{IE S 1 string dup 0 3 index put cvn put}for
65781.76 div /vsize X 65781.76 div /hsize X}N /p{show}N /RMat[1 0 0 -1 0
0]N /BDot 260 string N /rulex 0 N /ruley 0 N /v{/ruley X /rulex X V}B /V
{}B /RV statusdict begin /product where{pop product dup length 7 ge{0 7
getinterval dup(Display)eq exch 0 4 getinterval(NeXT)eq or}{pop false}
ifelse}{false}ifelse end{{gsave TR -.1 .1 TR 1 1 scale rulex ruley false
RMat{BDot}imagemask grestore}}{{gsave TR -.1 .1 TR rulex ruley scale 1 1
false RMat{BDot}imagemask grestore}}ifelse B /QV{gsave newpath transform
round exch round exch itransform moveto rulex 0 rlineto 0 ruley neg
rlineto rulex neg 0 rlineto fill grestore}B /a{moveto}B /delta 0 N /tail
{dup /delta X 0 rmoveto}B /M{S p delta add tail}B /b{S p tail}B /c{-4 M}
B /d{-3 M}B /e{-2 M}B /f{-1 M}B /g{0 M}B /h{1 M}B /i{2 M}B /j{3 M}B /k{
4 M}B /w{0 rmoveto}B /l{p -4 w}B /m{p -3 w}B /n{p -2 w}B /o{p -1 w}B /q{
p 1 w}B /r{p 2 w}B /s{p 3 w}B /t{p 4 w}B /x{0 S rmoveto}B /y{3 2 roll p
a}B /bos{/SS save N}B /eos{SS restore}B end
%%EndProcSet
%%BeginProcSet: texps.pro
TeXDict begin /rf{findfont dup length 1 add dict begin{1 index /FID ne 2
index /UniqueID ne and{def}{pop pop}ifelse}forall[1 index 0 6 -1 roll
exec 0 exch 5 -1 roll VResolution Resolution div mul neg 0 0]/Metrics
exch def dict begin Encoding{exch dup type /integertype ne{pop pop 1 sub
dup 0 le{pop}{[}ifelse}{FontMatrix 0 get div Metrics 0 get div def}
ifelse}forall Metrics /Metrics currentdict end def[2 index currentdict
end definefont 3 -1 roll makefont /setfont load]cvx def}def
/ObliqueSlant{dup sin S cos div neg}B /SlantFont{4 index mul add}def
/ExtendFont{3 -1 roll mul exch}def /ReEncodeFont{/Encoding exch def}def
end
%%EndProcSet
TeXDict begin 40258431 52099146 1000 300 300
(/usr/stsci/stsdasx/lib/hstio/doc/hstio.dvi) @start /Fa
160[30 95[{}1 50.000000 /Courier rf /Fb 134[29 1[42 29
32 19 23 26 1[32 29 32 48 16 32 1[16 32 29 19 26 32 26
1[29 12[39 32 42 2[45 1[55 39 2[23 45 1[36 1[42 2[42
7[29 1[29 29 29 29 29 29 29 1[16 15 19 15 44[{}44 58.333336
/Times-Bold rf /Fc 47[50 21[22 10[28 28 3[22 47[22 25
25 36 25 25 14 19 17 25 25 25 25 39 14 25 14 14 25 25
17 22 25 22 25 22 3[17 1[17 1[36 36 2[36 30 28 33 1[28
36 36 44 30 36 1[17 36 36 28 30 36 1[33 36 5[14 14 25
25 25 25 25 25 25 25 25 25 14 12 17 12 2[17 17 17 4[20
34[{}73 50.000000 /Times-Roman rf /Fd 60[20 69[20 20
20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20
20 20 20 20 20 20 20 20 20 1[20 1[20 20 20 20 20 20 20
20 20 20 20 20 20 20 20 20 20 20 20 1[20 20 20 20 20
20 20 20 20 2[20 20 20 20 20 20 20 20 20 20 20 20 20
20 20 20 20 20 20 20 20 20 20 1[20 20 1[20 20 20 33[{}87
33.333332 /Courier rf /Fe 139[17 19 3[25 2[14 2[14 28
2[22 16[33 13[30 23[12 46[{}10 50.000000 /Times-Bold
rf /Ff 133[31 35 35 51 35 39 23 27 31 1[39 35 39 59 20
2[20 39 35 23 31 39 31 1[35 11[51 47 39 51 1[43 55 1[67
1[55 1[27 55 55 43 47 3[51 7[35 35 35 35 35 35 35 35
35 2[18 23 45[{}47 70.833336 /Times-Bold rf /Fg 138[29
16 23 19 1[29 29 29 45 16 2[16 1[29 19 26 29 26 1[26
12[36 32 9[19 2[32 36 3[42 54 5[16 29 2[29 3[29 29 2[15
19 15 44[{}31 58.333336 /Times-Roman rf /Fh 139[23 32
28 1[42 42 42 1[23 2[23 42 1[28 37 42 37 1[37 12[51 46
2[46 60 60 74 3[28 60 3[60 55 1[60 65[{}25 83.333336
/Times-Roman rf end
%%EndProlog
%%BeginSetup
%%Feature: *Resolution 300dpi
TeXDict begin

%%EndSetup
%%Page: 1 1
1 0 bop 110 261 a Fh(A)21 b(Descritpion)e(of)h(the)g(HSTIO)g(Interf)o
(ace)f(to)i(the)f(STIS)g(and)686 365 y(NICMOS)h(Pipelines)871
564 y Fg(Allen)15 b(F)o(arris)618 639 y(Space)f(T)l(elescope)f(Science)
h(Institute)724 713 y(E-mail:)21 b(f)o(arris@stsci.edu)817
879 y(August)15 b(21,)f(1996)35 1147 y Ff(1)89 b(The)18
b(HSTIO)g(Header)h(File)198 1288 y Fe(The)12 b(hstio.h)g(File)155
1415 y Fd(1:)79 b(#)20 b(if)g(!defined\(HSTIO_\))155
1454 y(2:)79 b(#)20 b(define)g(HSTIO_)155 1494 y(3:)155
1533 y(4:)79 b(#if)20 b(defined\(__cplusplus\))155 1573
y(5:)79 b(extern)20 b("C")g({)155 1612 y(6:)79 b(#)20
b(endif)155 1652 y(7:)155 1691 y(8:)79 b(/*)155 1730
y(9:)g(**)20 b(Data)g(Structures)f(and)h(I/O)f(Function)h(Declarations)
f(for)135 1770 y(10:)79 b(**)20 b(STScI)g(Calibration)f(Pipeline)g
(Software)g(for)h(STIS)g(and)g(NICMOS)135 1809 y(11:)79
b(**)135 1849 y(12:)g(**)20 b(Version)g(1.20)135 1888
y(13:)79 b(**)135 1928 y(14:)g(**)20 b(Nov.)g(29,)f(1995)135
1967 y(15:)79 b(**)135 2006 y(16:)g(**)20 b(Table)g(of)f(Contents)135
2046 y(17:)79 b(**)120 b(Basic)19 b(structures)h(to)f(represent)h
(two-dimensional)e(arrays.)135 2085 y(18:)79 b(**)120
b(Definitions)19 b(of)h(Science,)f(Data)h(Quality)f(and)h(Error)f
(data.)135 2125 y(19:)79 b(**)120 b(Macros)19 b(to)h(implement)f(2-d)h
(array)g(indexing.)135 2164 y(20:)79 b(**)120 b(Definition)19
b(of)h(data)f(sections.)135 2204 y(21:)79 b(**)120 b(Definition)19
b(of)h(Header)f("card")h(image)f(arrays.)135 2243 y(22:)79
b(**)120 b(Definition)19 b(of)h(I/O)f(descriptor.)135
2283 y(23:)79 b(**)120 b(Definitions)19 b(of)h(Single)f(and)h
(Multi-Group)f(data)h(structures.)135 2322 y(24:)79 b(**)120
b(Declarations)19 b(of)h(error)f(handling)g(functions.)135
2361 y(25:)79 b(**)120 b(Declarations)19 b(of)h(high-level)f(I/O)g
(functions.)135 2401 y(26:)79 b(**)120 b(Declarations)19
b(of)h(header)f(manipulation)g(functions.)135 2440 y(27:)79
b(**)120 b(Declarations)19 b(of)h(low-level)f(I/O)h(functions.)135
2480 y(28:)79 b(**)120 b(Declarations)19 b(of)h(functions)f(to)h
(initialize,)f(allocate)g(and)h(free)135 2519 y(29:)79
b(**)279 b(data)20 b(storage)f(contained)g(within)h(data)g(structures.)
135 2559 y(30:)79 b(**)135 2598 y(31:)g(**)20 b(History)135
2637 y(32:)79 b(**)20 b(Version)g(1.00)f(\(06/21/95\).)135
2677 y(33:)79 b(**)20 b(Revisions)f(to)h(version)g(1.00)f(to)h(produce)
f(version)h(1.01)f(\(08/03/95\).)135 2716 y(34:)79 b(**)120
b(Corrected)19 b(bug)h(in)g(definition)f(of)g(IHdr.)998
2841 y Fc(1)p eop
%%Page: 2 2
2 1 bop 135 58 a Fd(35:)79 b(**)120 b(Changed)19 b(declaration)g(of)h
(putMultiGroup)f(function.)135 97 y(36:)79 b(**)120 b(Changed)19
b(the)h(ordering)f(within)h(structures)f(to)h(Sci,)f(Err,)h(Dq.)135
137 y(37:)79 b(**)20 b(Revisions)f(to)h(version)g(1.01)f(to)h(produce)f
(version)h(1.10)f(\(09/28/95\).)135 176 y(38:)79 b(**)120
b(Corrected)19 b(bug)h(in)g(definition)f(of)g(OUT_OPTION.)135
216 y(39:)79 b(**)120 b(Added)19 b(ifdef)h(extern)f(C)h(to)g
(accomodate)f(C++.)135 255 y(40:)79 b(**)120 b(Added)19
b(support)h(for)f(NICMOS)h(samples)f(and)h(integration)f(time)h(data.)
135 294 y(41:)79 b(**)120 b(Made)19 b(IODesc)h(structure)f(private)h
(by)f(changing)h(to)f(void)h(pointer)135 334 y(42:)79
b(**)199 b(and)20 b(changed)g(the)f(definitions)g(of)h(the)g
(IO_OPTIONS)f(and)h(added)135 373 y(43:)79 b(**)199 b(functions)20
b(to)g(retrieve)f(data)g(from)h(the)g(IODesc)f(structure.)135
413 y(44:)79 b(**)120 b(Added)19 b(open)h(and)g(close)f(FITS)h(file)f
(functions.)135 452 y(45:)79 b(**)120 b(Major)19 b(revision)h(to)f
(functions)h(to)f(manipulate)h(header)f(arrays.)135 492
y(46:)79 b(**)120 b(Added)19 b(additional)h(error)f(handling)g
(functions)135 531 y(47:)79 b(**)120 b(Revised)19 b(definition)g(of)h
(single)g(and)f(multi-group)g(structures)135 570 y(48:)79
b(**)199 b(to)20 b(achieve)g(greater)f(compatibility)g(between)g(the)h
(two)135 610 y(49:)79 b(**)20 b(Revisions)f(to)h(version)g(1.10)f(to)h
(produce)f(version)h(1.11)f(\(09/29/95\).)135 649 y(50:)79
b(**)120 b(Added)19 b(an)h(option)g(parameter)f(to)h(the)f(putGroupHdr)
g(functions.)135 689 y(51:)79 b(**)20 b(Revisions)f(to)h(version)g
(1.11)f(to)h(produce)f(version)h(1.20)f(\(11/29/95\).)135
728 y(52:)79 b(**)120 b(Major)19 b(revisions)h(to)f(the)h(low-level)f
(I/O)h(function)f(and)h(to)g(the)135 768 y(53:)79 b(**)199
b(low-level)20 b(data)f(structures.)39 b(References)20
b(to)f(Sci,)h(Err,)g(and)135 807 y(54:)79 b(**)199 b(DQ)20
b(were)g(removed)f(from)h(the)g(low-level)f(structure)g(and)h(function)
135 847 y(55:)79 b(**)199 b(names)20 b(in)g(favor)f(of)h(generic)g
(names)f(such)h(as)g(float)f(and)h(short.)135 886 y(56:)79
b(**)135 925 y(57:)g(**)135 965 y(58:)g(*/)135 1004 y(59:)135
1044 y(60:)g(#)20 b(include)g(<stdlib.h>)135 1083 y(61:)135
1123 y(62:)79 b(typedef)20 b(struct)f({)135 1162 y(63:)239
b(short)19 b(*buffer;)199 b(/*)20 b(the)f(pointer)h(to)g(the)f(beg.)h
(of)g(the)f(buffer)h(*/)135 1201 y(64:)239 b(int)19 b(buffer_size;)159
b(/*)20 b(the)f(size)h(of)g(the)g(full)f(2-d)h(array)f(in)h(the)g(*/)
135 1241 y(65:)239 b(int)19 b(tot_nx;)259 b(/*)20 b(buffer.)617
b(*/)135 1280 y(66:)239 b(int)19 b(tot_ny;)259 b(/*)99
b(buffer_size)20 b(=)f(tot_nx*tot_ny)139 b(*/)135 1320
y(67:)239 b(int)19 b(nx;)339 b(/*)20 b(The)f(size)h(of)g(the)g(current)
f("view")g(of)h(the)g(*/)135 1359 y(68:)239 b(int)19
b(ny;)339 b(/*)20 b(full)f(2-d)h(array.)458 b(*/)135
1399 y(69:)239 b(short)19 b(*data;)239 b(/*)20 b(The)f(pointer)h(to)g
(the)f(beginning)h(of)f(the)60 b(*/)135 1438 y(70:)717
b(/*)20 b(subsection)f(of)h(the)f(full)h(2-d)g(array.)99
b(*/)135 1478 y(71:)79 b(})20 b(ShortTwoDArray;)135 1517
y(72:)135 1556 y(73:)79 b(typedef)20 b(struct)f({)135
1596 y(74:)239 b(float)19 b(*buffer;)135 1635 y(75:)239
b(int)19 b(buffer_size;)135 1675 y(76:)239 b(int)19 b(tot_nx;)135
1714 y(77:)239 b(int)19 b(tot_ny;)135 1754 y(78:)239
b(int)19 b(nx;)135 1793 y(79:)239 b(int)19 b(ny;)135
1832 y(80:)239 b(float)19 b(*data;)135 1872 y(81:)79
b(})20 b(FloatTwoDArray;)135 1911 y(82:)135 1951 y(83:)135
1990 y(84:)79 b(/*)135 2030 y(85:)g(**)20 b(The)g(Following)f(macros)h
(are)f(used)h(to)g(represent)f(2-d)h(indexing.)135 2069
y(86:)79 b(**)20 b(Two)g(dimensional)f(arrays)g(are)h(stored)g(in)f
(FITS)h(order.)135 2108 y(87:)79 b(**)135 2148 y(88:)g(**)160
b(ny)135 2187 y(89:)79 b(**)160 b(\303)135 2227 y(90:)79
b(**)120 b(N)20 b(|)f(a05)60 b(a15)g(a25)f(a35)135 2266
y(91:)79 b(**)120 b(A)20 b(|)f(a04)60 b(a14)g(a24)f(a34)135
2306 y(92:)79 b(**)120 b(X)20 b(|)f(a03)60 b(a13)g(a23)f(a33)135
2345 y(93:)79 b(**)120 b(I)20 b(|)f(a02)60 b(a12)g(a22)f(a32)135
2385 y(94:)79 b(**)120 b(S)20 b(|)f(a01)60 b(a11)g(a21)f(a31)135
2424 y(95:)79 b(**)120 b(2)20 b(|)f(a00)60 b(a10)g(a20)f(a30)135
2463 y(96:)79 b(**)180 b(--------------------------->)17
b(nx)135 2503 y(97:)79 b(**)239 b(NAXIS1)135 2542 y(98:)79
b(**)135 2582 y(99:)g(**)120 b(NAXIS1)19 b(is)h(4)g(and)g(NAXIS2)f(is)h
(6)115 2621 y(100:)79 b(**)120 b(PIX\(a,1,4\))19 b(accesses)g(a14)115
2661 y(101:)79 b(*/)115 2700 y(102:)998 2841 y Fc(2)p
eop
%%Page: 3 3
3 2 bop 115 58 a Fd(103:)79 b(#)20 b(define)g(Pix\(a,i,j\))119
b(\(a\).data[\(j\)*\(a\).tot_nx)18 b(+)i(\(i\)])115 97
y(104:)79 b(#)20 b(define)g(DQPix\(a,i,j\))79 b
(\(a\).data[\(j\)*\(a\).tot_nx)18 b(+)i(\(i\)])115 137
y(105:)79 b(#)20 b(define)g(DQSetPix\(a,i,j,value\))e
(\(a\).data[\(j\)*\(a\).tot_nx)g(+)i(\(i\)])g(=)g(\(value\))115
176 y(106:)115 216 y(107:)79 b(#)20 b(define)g(PPix\(a,i,j\))118
b(\(a\)->data[\(j\)*\(a\)->tot_nx)19 b(+)g(\(i\)])115
255 y(108:)79 b(#)20 b(define)g(PDQPix\(a,i,j\))78 b
(\(a\)->data[\(j\)*\(a\)->tot_nx)19 b(+)g(\(i\)])115
294 y(109:)79 b(#)20 b(define)g(PDQSetPix\(a,i,j,value\))e
(\(a\)->data[\(j\)*\(a\)->tot_nx)g(+)i(\(i\)])g(=)f(\(value\))115
334 y(110:)115 373 y(111:)79 b(/*)115 413 y(112:)g(**)279
b(Examples)20 b(of)f(using)h(macros.)115 452 y(113:)79
b(**)115 492 y(114:)g(**)20 b(Suppose)g(we)f(have)h(the)g(following)f
(declarations)g(and)h(that)f(these)h(data)115 531 y(115:)79
b(**)20 b(structures)f(have)h(been)g(properly)f(initialized)g(and)h
(allocated.)115 570 y(116:)79 b(**)115 610 y(117:)g(**)120
b(SciData)19 b(picture;)115 649 y(118:)79 b(**)120 b(DQData)19
b(dataqual_in1,)g(dataqual_in2,)g(dataqual_out;)115 689
y(119:)79 b(**)120 b(short)19 b(val;)115 728 y(120:)79
b(**)115 768 y(121:)g(**)20 b(Now)g(set)g(all)f(the)h(diagonal)f
(pixels)h(in)g(the)f(picture)h(array)f(to)h(1.)115 807
y(122:)79 b(**)115 847 y(123:)g(**)120 b(for)19 b(\(i)h(=)g(0;)g(i)g(<)
g(min\(picture.nx,picture.ny\);)e(i++\))115 886 y(124:)79
b(**)279 b(Pix\(picture,i,i\))19 b(=)h(1.0F;)115 925
y(125:)79 b(**)115 965 y(126:)g(**)20 b(Now)g(combine)f(the)h(two)g
(data)f(quality)h(arrays.)115 1004 y(127:)79 b(**)115
1044 y(128:)g(**)120 b(for)19 b(\()h(j)g(=)g(0;)g(j)g(<)g
(dataqual_out.ny;)e(j++\))115 1083 y(129:)79 b(**)199
b(for)20 b(\(i)g(=)g(0;)g(i)f(<)h(dataqual_out.nx;)f(i++\))h({)115
1123 y(130:)79 b(**)279 b(val)20 b(=)g(DQPix\(dataqual_in1,i,j\))e(|)i
(DQPix\(dataqual_in2,i,j\);)115 1162 y(131:)79 b(**)279
b(DQSetPix\(dataqual_out,i,j,val\);)115 1201 y(132:)79
b(**)199 b(})115 1241 y(133:)79 b(**)115 1280 y(134:)g(*/)115
1320 y(135:)115 1359 y(136:)g(/*)115 1399 y(137:)g(**)20
b(The)g(data)f(section)h(structure)f(can)h(be)g(used)f(to)h(read)g
(sections)f(of)h(an)g(image)115 1438 y(138:)79 b(**)20
b(from)g(disk)f(into)h(memory.)39 b(It)20 b(is)g(intended)f(to)h(be)g
(used)f(only)h(for)g(high-level)115 1478 y(139:)79 b(**)20
b(I/O)g(operations.)39 b(At)20 b(present,)f(the)h(entire)f(array)h(is)g
(read)f(into)h(memory.)115 1517 y(140:)79 b(*/)115 1556
y(141:)g(typedef)20 b(struct)f({)115 1596 y(142:)239
b(int)19 b(x_beg;)279 b(/*)20 b(The)f(beginning)h(coordinates)f(of)h
(the)99 b(*/)115 1635 y(143:)239 b(int)19 b(y_beg;)279
b(/*)20 b(section.)577 b(*/)115 1675 y(144:)239 b(int)19
b(sx;)339 b(/*)20 b(The)f(sizes)h(of)g(the)g(X)f(and)h(Y)g(dimensions)
39 b(*/)115 1714 y(145:)239 b(int)19 b(sy;)339 b(/*)20
b(of)g(the)f(section.)438 b(*/)115 1754 y(146:)79 b(})20
b(DataSection;)115 1793 y(147:)115 1832 y(148:)79 b(#)20
b(define)g(HDRSize)f(81)115 1872 y(149:)79 b(typedef)20
b(char)f(HdrArray[HDRSize];)g(/*)h(Headers)f(are)h(simply)f(an)h(array)
g(of)f(fixed)h(*/)115 1911 y(150:)717 b(/*)20 b(length,)f(null)h
(terminated)f(strings)g(that)h(*/)115 1951 y(151:)717
b(/*)20 b(represent)f(FITS)h(card)f(images.)199 b(*/)115
1990 y(152:)115 2030 y(153:)79 b(typedef)20 b(struct)f({)115
2069 y(154:)239 b(int)19 b(nlines;)259 b(/*)20 b(The)f(number)h(of)g
(lines)f(actually)h(used.)59 b(*/)115 2108 y(155:)239
b(int)19 b(nalloc;)259 b(/*)20 b(Number)f(of)h(lines)g(currently)f
(allocated.)g(*/)115 2148 y(156:)239 b(HdrArray)19 b(*array;)159
b(/*)20 b(The)f(buffer)h(of)g(card)f(images.)219 b(*/)115
2187 y(157:)79 b(})20 b(Hdr;)115 2227 y(158:)115 2266
y(159:)79 b(/*)115 2306 y(160:)g(**)20 b(I/O)g(Options)f(and)h(the)g
(I/O)f(Descriptor)h(Pointer)115 2345 y(161:)79 b(**)115
2385 y(162:)g(**)20 b(The)g(I/O)g(descriptor)f(pointer)g(points)h(to)f
(an)h(I/O)g(structure)f(that)h(is)115 2424 y(163:)79
b(**)20 b(used)g(internally)f(within)g(the)h(I/O)g(functions.)115
2463 y(164:)79 b(*/)115 2503 y(165:)g(#)20 b(if)g
(!defined\(IO_OPTIONS_\))115 2542 y(166:)79 b(#)20 b(define)g
(IO_OPTIONS_)115 2582 y(167:)79 b(enum)20 b(IO_OPTION_)f({)115
2621 y(168:)239 b(Sequential)19 b(=)h(0x1,)115 2661 y(169:)239
b(Random)19 b(=)h(0x2,)115 2700 y(170:)239 b(ReadOnly)19
b(=)h(0x4,)998 2841 y Fc(3)p eop
%%Page: 4 4
4 3 bop 115 58 a Fd(171:)239 b(WriteOnly)19 b(=)h(0x8,)115
97 y(172:)239 b(ReadWrite)19 b(=)h(0x10,)115 137 y(173:)239
b(New)19 b(=)h(0x20,)115 176 y(174:)239 b(Overwrite)19
b(=)h(0x40,)115 216 y(175:)239 b(Force)19 b(=)h(0x80,)115
255 y(176:)239 b(Inherit)19 b(=)h(0x100,)115 294 y(177:)239
b(Dupname)19 b(=)h(0x200,)115 334 y(178:)239 b(NoDupname)19
b(=)h(0x400,)115 373 y(179:)239 b(RemainOpen)19 b(=)h(0x800,)115
413 y(180:)239 b(Geis)19 b(=)h(0x1000,)115 452 y(181:)239
b(Tape9)19 b(=)h(0x2000,)115 492 y(182:)239 b(Std)19
b(=)h(0x4000,)115 531 y(183:)239 b(Disk)19 b(=)h(0x8000)115
570 y(184:)79 b(};)115 610 y(185:)g(typedef)20 b(enum)f(IO_OPTION_)h
(OP_OPTION;)115 649 y(186:)79 b(#)20 b(endif)115 689
y(187:)79 b(typedef)20 b(void)f(*IODescPtr;)115 728 y(188:)115
768 y(189:)79 b(/*)115 807 y(190:)g(**)20 b(The)g(following)f(data)h
(structures)f(define)g(combinations)g(of)h(both)115 847
y(191:)79 b(**)20 b(headers)g(and)f(data.)115 886 y(192:)79
b(*/)115 925 y(193:)g(typedef)20 b(struct)f({)115 965
y(194:)239 b(IODescPtr)19 b(iodesc;)115 1004 y(195:)239
b(DataSection)19 b(section;)115 1044 y(196:)239 b(Hdr)19
b(hdr;)115 1083 y(197:)239 b(FloatTwoDArray)19 b(data;)115
1123 y(198:)79 b(})20 b(FloatHdrData;)115 1162 y(199:)115
1201 y(200:)79 b(typedef)20 b(struct)f({)115 1241 y(201:)239
b(IODescPtr)19 b(iodesc;)115 1280 y(202:)239 b(DataSection)19
b(section;)115 1320 y(203:)239 b(Hdr)19 b(hdr;)115 1359
y(204:)239 b(ShortTwoDArray)19 b(data;)115 1399 y(205:)79
b(})20 b(ShortHdrData;)115 1438 y(206:)115 1478 y(207:)79
b(typedef)20 b(FloatHdrData)f(SciHdrData;)115 1517 y(208:)79
b(typedef)20 b(FloatHdrData)f(ErrHdrData;)115 1556 y(209:)79
b(typedef)20 b(ShortHdrData)f(DQHdrData;)115 1596 y(210:)79
b(typedef)20 b(ShortHdrData)f(SmplHdrData;)115 1635 y(211:)79
b(typedef)20 b(FloatHdrData)f(IntgHdrData;)115 1675 y(212:)115
1714 y(213:)79 b(/*)115 1754 y(214:)g(**)20 b(The)g(SingleGroup)f(data)
h(structure)f(is)h(used)f(for)h(single)f(images)h(or)g(single)115
1793 y(215:)79 b(**)20 b(groups)g(from)f(a)h(multi-group)f(file.)40
b(The)19 b(disk)h(file)g(name)f(together)h(with)115 1832
y(216:)79 b(**)20 b(the)g(group)f(number)h(uniquely)f(identifies)g(the)
h(source)g(of)f(the)h(data)g(array)115 1872 y(217:)79
b(**)20 b(in)g(the)g(file.)39 b(The)20 b(group)f(number)h(is)g(the)f
(FITS)h(EXTVER)f(keyword)h(value.)115 1911 y(218:)79
b(*/)115 1951 y(219:)g(typedef)20 b(struct)f({)115 1990
y(220:)239 b(char)19 b(*filename;)115 2030 y(221:)239
b(int)19 b(group_num;)115 2069 y(222:)239 b(Hdr)19 b(*globalhdr;)115
2108 y(223:)239 b(SciHdrData)19 b(sci;)115 2148 y(224:)239
b(ErrHdrData)19 b(err;)115 2187 y(225:)239 b(DQHdrData)19
b(dq;)115 2227 y(226:)79 b(})20 b(SingleGroup;)115 2266
y(227:)115 2306 y(228:)79 b(typedef)20 b(struct)f({)115
2345 y(229:)239 b(char)19 b(*filename;)115 2385 y(230:)239
b(int)19 b(group_num;)115 2424 y(231:)239 b(Hdr)19 b(*globalhdr;)115
2463 y(232:)239 b(SciHdrData)19 b(sci;)115 2503 y(233:)239
b(ErrHdrData)19 b(err;)115 2542 y(234:)239 b(DQHdrData)19
b(dq;)115 2582 y(235:)239 b(SmplHdrData)19 b(smpl;)115
2621 y(236:)239 b(IntgHdrData)19 b(intg;)115 2661 y(237:)79
b(})20 b(SingleNicmosGroup;)115 2700 y(238:)998 2841
y Fc(4)p eop
%%Page: 5 5
5 4 bop 115 58 a Fd(239:)79 b(/*)115 97 y(240:)g(**)20
b(The)g(MultiGroup)f(data)h(structure)f(is)h(used)f(to)h(read)g
(members)f(of)h(a)g(multi-group)115 137 y(241:)79 b(**)20
b(file.)115 176 y(242:)79 b(*/)115 216 y(243:)g(typedef)20
b(struct)f({)115 255 y(244:)239 b(int)19 b(ngroups;)239
b(/*)20 b(number)f(of)h(groups)g(contained)f(in)h(the)f(struct)40
b(*/)115 294 y(245:)239 b(SingleGroup)19 b(*group;)115
334 y(246:)79 b(})20 b(MultiGroup;)115 373 y(247:)115
413 y(248:)79 b(typedef)20 b(struct)f({)115 452 y(249:)239
b(int)19 b(ngroups;)239 b(/*)20 b(number)f(of)h(groups)g(contained)f
(in)h(the)f(struct)40 b(*/)115 492 y(250:)239 b(SingleNicmosGroup)18
b(*group;)115 531 y(251:)79 b(})20 b(MultiNicmosGroup;)115
570 y(252:)115 610 y(253:)79 b(/*)115 649 y(254:)g(**)20
b(Error)g(Handling)f(Function)g(Declarations)115 689
y(255:)79 b(*/)115 728 y(256:)g(enum)20 b(HSTIOERROR_)f({)115
768 y(257:)239 b(OK,)19 b(NOMEM,)h(BADOPEN,)f(BADCLOSE,)h(BADREAD,)f
(BADWRITE,)g(BADEXTNAME,)115 807 y(258:)239 b(BADHSIZE,)19
b(NOGET,)h(NOPUT,)f(BADDIMS,)g(BADTYPE,)h(NOSCI,)f(BADSCIDIMS,)115
847 y(259:)239 b(BADGROUP,)19 b(BADGET,)g(BADFITSEQ,)h(BADFITSQUOTE,)f
(BADFITSNUMERIC,)115 886 y(260:)239 b(BADFITSTYPE,)19
b(BADPUT,)g(BADNAME,)h(BADBITPIX,)f(BADNDIM,)g(BADEXIST)115
925 y(261:)79 b(};)115 965 y(262:)g(typedef)20 b(enum)f(HSTIOERROR_)h
(HSTIOError;)115 1004 y(263:)79 b(HSTIOError)20 b(hstio_err\(\);)115
1044 y(264:)79 b(char)20 b(*hstio_errmsg\(\);)115 1083
y(265:)79 b(typedef)20 b(void)f(\(*HSTIOErrHandler\)\(\);)115
1123 y(266:)79 b(int)20 b(push_hstioerr\(HSTIOErrHandler\);)115
1162 y(267:)79 b(int)20 b(pop_hstioerr\(\);)115 1201
y(268:)115 1241 y(269:)79 b(/*)115 1280 y(270:)g(**)20
b(High-level)f(I/O)h(Function)f(Declarations)115 1320
y(271:)79 b(*/)115 1359 y(272:)g(int)20 b(openFitsFile\(char)f
(*filename,)g(unsigned)g(long)h(option\);)115 1399 y(273:)79
b(int)20 b(closeFitsFile\(char)f(*filename\);)115 1438
y(274:)79 b(int)20 b(getSci\(char)f(*filename,)g(int)h(extver,)f
(SciHdrData)h(*\);)115 1478 y(275:)79 b(int)20 b(putSci\(char)f
(*filename,)g(int)h(extver,)f(SciHdrData)h(*,)f(int)h(option\);)115
1517 y(276:)79 b(int)20 b(getErr\(char)f(*filename,)g(int)h(extver,)f
(ErrHdrData)h(*\);)115 1556 y(277:)79 b(int)20 b(putErr\(char)f
(*filename,)g(int)h(extver,)f(ErrHdrData)h(*,)f(int)h(option\);)115
1596 y(278:)79 b(int)20 b(getDQ\(char)f(*filename,)g(int)h(extver,)g
(DQHdrData)f(*\);)115 1635 y(279:)79 b(int)20 b(putDQ\(char)f
(*filename,)g(int)h(extver,)g(DQHdrData)f(*,)h(int)f(option\);)115
1675 y(280:)79 b(int)20 b(getSmpl\(char)f(*filename,)g(int)h(extver,)f
(SmplHdrData)h(*\);)115 1714 y(281:)79 b(int)20 b(putSmpl\(char)f
(*filename,)g(int)h(extver,)f(SmplHdrData)h(*,)f(int)h(option\);)115
1754 y(282:)79 b(int)20 b(getIntg\(char)f(*filename,)g(int)h(extver,)f
(IntgHdrData)h(*\);)115 1793 y(283:)79 b(int)20 b(putIntg\(char)f
(*filename,)g(int)h(extver,)f(IntgHdrData)h(*,)f(int)h(option\);)115
1832 y(284:)79 b(int)20 b(getFloatHD\(char)f(*filename,)g(char)h
(*extname,)f(int)h(extver,)f(FloatHdrData)g(*\);)115
1872 y(285:)79 b(int)20 b(putFloatHD\(char)f(*filename,)g(char)h
(*extname,)f(int)h(extver,)f(FloatHdrData)g(*,)h(int)g(option\);)115
1911 y(286:)79 b(int)20 b(getShortHD\(char)f(*filename,)g(char)h
(*extname,)f(int)h(extver,)f(ShortHdrData)g(*\);)115
1951 y(287:)79 b(int)20 b(putShortHD\(char)f(*filename,)g(char)h
(*extname,)f(int)h(extver,)f(ShortHdrData)g(*,)h(int)g(option\);)115
1990 y(288:)79 b(int)20 b(getSingleGroup\(char)f(*filename,)g(int)g
(extver,)h(SingleGroup)f(*\);)115 2030 y(289:)79 b(int)20
b(putSingleGroupHdr\(char)e(*filename,)i(SingleGroup)f(*,)g(int)h
(option\);)115 2069 y(290:)79 b(int)20 b(putSingleGroup\(char)f
(*filename,)g(int)g(extver,)h(SingleGroup)f(*,)h(int)f(option\);)115
2108 y(291:)79 b(int)20 b(getSingleNicmosGroup\(char)e(*filename,)h
(int)h(extver,)f(SingleNicmosGroup)g(*\);)115 2148 y(292:)79
b(int)20 b(putSingleNicmosGroupHdr\(char)e(*filename,)h
(SingleNicmosGroup)g(*,)h(int)f(option\);)115 2187 y(293:)79
b(int)20 b(putSingleNicmosGroup\(char)e(*filename,)h(int)h(extver,)f
(SingleNicmosGroup)g(*,)115 2227 y(294:)239 b(int)19
b(option\);)115 2266 y(295:)79 b(int)20 b(getMultiGroupHdr\(char)e
(*filename,)i(MultiGroup)f(*\);)115 2306 y(296:)79 b(int)20
b(getMultiGroup\(MultiGroup)e(*,)i(int)g(ngroup,)f(int)h(extver\);)115
2345 y(297:)79 b(int)20 b(putMultiGroupHdr\(char)e(*filename,)i
(MultiGroup)f(*,)h(int)f(option\);)115 2385 y(298:)79
b(int)20 b(putMultiGroup\(char)f(*filename,)g(int)h(extver,)f
(MultiGroup)g(*,)h(int)g(ngroup,)115 2424 y(299:)239
b(int)19 b(option\);)115 2463 y(300:)79 b(int)20 b
(getMultiNicmosGroupHdr\(char)e(*filename,)h(MultiNicmosGroup)g(*\);)
115 2503 y(301:)79 b(int)20 b(getMultiNicmosGroup\(MultiNicmosGroup)d
(*,)j(int)g(ngroup,)f(int)h(extver\);)115 2542 y(302:)79
b(int)20 b(putMultiNicmosGroupHdr\(char)e(*filename,)h
(MultiNicmosGroup)g(*,)h(int)f(option\);)115 2582 y(303:)79
b(int)20 b(putMultiNicmosGroup\(char)e(*filename,)h(int)h(extver,)g
(MultiNicmosGroup)e(*,)115 2621 y(304:)239 b(int)19 b(ngroup,)h(int)g
(option\);)115 2661 y(305:)115 2700 y(306:)79 b(/*)998
2841 y Fc(5)p eop
%%Page: 6 6
6 5 bop 115 58 a Fd(307:)79 b(**)20 b(Functions)f(for)h(Accessing)f
(and)h(Manipulating)f(Keywords)g(in)h(a)g(FITS)g(Keyword)f(List)115
97 y(308:)79 b(*/)115 137 y(309:)115 176 y(310:)g(#)20
b(if)g(!defined\(BOOL_\))115 216 y(311:)79 b(#)20 b(define)g(BOOL_)115
255 y(312:)79 b(enum)20 b(Bool_)g({)f(False)h(=)g(0,)g(True)f(=)h(1)g
(};)115 294 y(313:)79 b(typedef)20 b(enum)f(Bool_)h(Bool;)115
334 y(314:)79 b(#)20 b(endif)115 373 y(315:)79 b(#)20
b(define)g(NotFound)f(NULL)115 413 y(316:)79 b(typedef)20
b(void)f(*FitsKw;)115 452 y(317:)79 b(enum)20 b(FitsDataType_)f({)h
(FITSNOVALUE)f(=)h(0,)g(FITSLOGICAL,)f(FITSBIT,)g(FITSCHAR,)115
492 y(318:)239 b(FITSBYTE,)19 b(FITSSHORT,)g(FITSLONG,)g(FITSFLOAT,)h
(FITSDOUBLE,)f(FITSCOMPLEX,)115 531 y(319:)239 b(FITSICOMPLEX,)19
b(FITSDCOMPLEX,)g(FITSVADESC,)g(FITSSTRING)115 570 y(320:)79
b(};)115 610 y(321:)g(typedef)20 b(enum)f(FitsDataType_)g
(FitsDataType;)115 649 y(322:)115 689 y(323:)79 b(/*)115
728 y(324:)g(**)20 b(Making)g(a)f(FITS)h(Header)115 768
y(325:)79 b(**)115 807 y(326:)g(**)20 b(These)g(return)f(0)h(is)g
(successful)f(and)h(-1)f(if)h(an)g(error)g(occurred.)115
847 y(327:)79 b(*/)115 886 y(328:)g(int)20 b(makePrimaryArrayHdr\(Hdr)e
(*,)i(FitsDataType,)f(int)h(dims,)f(int)h(*ndim\);)115
925 y(329:)79 b(int)20 b(makeImageExtHdr\(Hdr)f(*,)g(FitsDataType,)g
(int)h(dims,)g(int)f(*ndim,)115 965 y(330:)239 b(char)19
b(*extname,)h(int)f(extver\);)115 1004 y(331:)115 1044
y(332:)79 b(/*)115 1083 y(333:)g(**)20 b(Finding)g(keywords)f(in)h(a)g
(FITS)f(keyword)h(list.)115 1123 y(334:)79 b(**)115 1162
y(335:)g(**)20 b(The)g("find")f(function)h(starts)f(at)h(the)g
(beginning)f(of)h(the)f(list)h(and)g(finds)f(the)115
1201 y(336:)79 b(**)20 b(first)g(occurence)f(of)h(the)f(desired)h
(keyword.)39 b(The)20 b("findnext")f(function)115 1241
y(337:)79 b(**)20 b(begins)g(at)f(the)h(current)g(position)f(and)h
(returns)f(the)h(next)f(occurence)h(of)f(the)115 1280
y(338:)79 b(**)20 b(keyword.)39 b(NotFound)20 b(is)g(returned)f(if)h
(no)f(such)h(keyword)f(is)h(found.)40 b(The)19 b("first")115
1320 y(339:)79 b(**)20 b(function)f(sets)h(the)g(current)f(position)h
(to)f(the)h(beginning)f(of)h(the)g(list.)115 1359 y(340:)79
b(**)20 b(The)g("next")f(function)h(sets)f(the)h(position)f(to)h(the)g
(next)f(keyword)h(in)g(the)f(list.)115 1399 y(341:)79
b(**)20 b("Next")g(returns)f(NotFound)g(after)h(the)g(last)f(keyword)h
(in)f(the)h(list.)40 b("GetKw")115 1438 y(342:)79 b(**)20
b(returns)g(the)f(n-th)h(keyword.)39 b(The)20 b(special)f(function)h
("insertfirst")f(is)g(used)h(to)115 1478 y(343:)79 b(**)20
b(position)f(the)h(cursor)g(prior)f(to)h(the)g(first)f(item)h(in)g(the)
f(list)h(so)g(that)f(a)h(new)115 1517 y(344:)79 b(**)20
b(keyword)g(may)f(be)h(inserted)f(at)h(the)g(beginning)f(of)h(the)g
(list.)39 b(\(Insert)19 b(functions)115 1556 y(345:)79
b(**)20 b(always)g(insert)f(keywords)g(at)h(a)g(position)f(after)h(the)
g(cursor.\))115 1596 y(346:)79 b(*/)115 1635 y(347:)g(FitsKw)20
b(findKw\(Hdr)f(*,)h(char)f(*name\);)115 1675 y(348:)79
b(FitsKw)20 b(findnextKw\(Hdr)f(*,)h(char)f(*name\);)115
1714 y(349:)79 b(FitsKw)20 b(first\(Hdr)f(*\);)115 1754
y(350:)79 b(FitsKw)20 b(next\(FitsKw\);)115 1793 y(351:)79
b(FitsKw)20 b(getKw\(Hdr)f(*,)h(int)g(n\);)115 1832 y(352:)79
b(FitsKw)20 b(insertfirst\(Hdr)f(*\);)115 1872 y(353:)115
1911 y(354:)79 b(/*)115 1951 y(355:)g(**)20 b(Accessing)f(and)h
(changing)f(name,)h(value,)f(or)h(comment)g(in)f(a)h(FITS)g(keyword.)
115 1990 y(356:)79 b(**)115 2030 y(357:)g(**)20 b(These)g(functions)f
(must)h(be)f(preceded)h(by)f(a)h("find")g(or)g("findnext")f(operation.)
115 2069 y(358:)79 b(**)20 b(Data)g(conversions)f(in)h(the)f("get")h
(routines:)115 2108 y(359:)79 b(**)279 b(FITS)20 b(Type)139
b(Possible)19 b(Requested)h(Type)115 2148 y(360:)79 b(**)279
b(---------)139 b(-----------------------)115 2187 y(361:)79
b(**)279 b(Logical)179 b(Bool,)20 b(Int)115 2227 y(362:)79
b(**)279 b(Int)259 b(Int,)20 b(Double)115 2266 y(363:)79
b(**)279 b(Float)219 b(Float,)19 b(Double)115 2306 y(364:)79
b(**)279 b(Double)199 b(Double)115 2345 y(365:)79 b(**)279
b(String)199 b(String)115 2385 y(366:)79 b(**)20 b(If)g(the)g
(requested)f(type)h(conversion)f(is)g(not)h(allowed,)g(an)f(error)h
(code)f(is)h(set.)115 2424 y(367:)79 b(*/)115 2463 y(368:)g(char)20
b(*getKwName\(FitsKw\);)115 2503 y(369:)79 b(char)20
b(*getKwComm\(FitsKw\);)115 2542 y(370:)79 b(FitsDataType)19
b(getKwType\(FitsKw\);)115 2582 y(371:)79 b(Bool)20 b
(getBoolKw\(FitsKw\);)115 2621 y(372:)79 b(int)40 b
(getIntKw\(FitsKw\);)115 2661 y(373:)79 b(float)20 b
(getFloatKw\(FitsKw\);)115 2700 y(374:)79 b(double)20
b(getDoubleKw\(FitsKw\);)998 2841 y Fc(6)p eop
%%Page: 7 7
7 6 bop 115 58 a Fd(375:)79 b(int)20 b(getStringKw\(FitsKw,)f(char)g
(*str,)h(int)f(maxch\);)115 97 y(376:)79 b(int)20 b(putKwName\(FitsKw,)
f(char)g(*name\);)115 137 y(377:)79 b(void)20 b(putKwComm\(FitsKw,)f
(char)g(*comment\);)115 176 y(378:)79 b(int)20 b(putBoolKw\(FitsKw,)f
(Bool)g(value\);)115 216 y(379:)79 b(int)20 b(putIntKw\(FitsKw,)f(int)h
(value\);)115 255 y(380:)79 b(int)20 b(putFloatKw\(FitsKw,)f(float)g
(value\);)115 294 y(381:)79 b(int)20 b(putDoubleKw\(FitsKw,)f(double)g
(value\);)115 334 y(382:)79 b(int)20 b(putStringKw\(FitsKw,)f(char)g
(*value\);)115 373 y(383:)115 413 y(384:)79 b(/*)115
452 y(385:)g(**)20 b(Adding)g(keywords)f(to)h(a)g(FITS)f(Header.)115
492 y(386:)79 b(**)115 531 y(387:)g(**)20 b(The)g(new)g(keywords)f(are)
h(added)f(to)h(the)g(end)f(of)h(the)g(keyword)f(list.)40
b(There)115 570 y(388:)79 b(**)20 b(is)g(no)g("END")f(keyword)h
(maintained)f(in)h(the)f(list.)40 b(The)20 b(software)f(writing)115
610 y(389:)79 b(**)20 b(the)g(FITS)f(header)h(automatically)f(adds)h
(an)f("END")h(keyword)f(before)h(writing)115 649 y(390:)79
b(**)20 b(the)g(header.)115 689 y(391:)79 b(**)115 728
y(392:)g(*/)115 768 y(393:)g(int)20 b(addBoolKw\(Hdr)f(*,)h(char)f
(*name,)h(Bool)g(value,)f(char)h(*comment\);)115 807
y(394:)79 b(int)20 b(addIntKw\(Hdr)f(*,)h(char)g(*name,)f(int)h(value,)
f(char)h(*comment\);)115 847 y(395:)79 b(int)20 b(addFloatKw\(Hdr)f(*,)
h(char)f(*name,)h(float)f(value,)h(char)g(*comment\);)115
886 y(396:)79 b(int)20 b(addDoubleKw\(Hdr)f(*,)h(char)f(*name,)h
(double)f(value,)h(char)f(*comment\);)115 925 y(397:)79
b(int)20 b(addStringKw\(Hdr)f(*,)h(char)f(*name,)h(char)f(*)h(value,)g
(char)f(*comment\);)115 965 y(398:)79 b(int)20 b(addSpacesKw\(Hdr)f(*,)
h(char)f(*comment\);)115 1004 y(399:)79 b(int)20 b(addCommentKw\(Hdr)f
(*,)h(char)f(*comment\);)115 1044 y(400:)79 b(int)20
b(addHistoryKw\(Hdr)f(*,)h(char)f(*comment\);)115 1083
y(401:)115 1123 y(402:)79 b(/*)115 1162 y(403:)g(**)20
b(Inserting)f(keywords)h(in)g(a)f(FITS)h(Header.)115
1201 y(404:)79 b(**)115 1241 y(405:)g(**)20 b(The)g(keywords)f(are)h
(inserted)f(after)h(the)f(current)h(position.)39 b(The)20
b(position)115 1280 y(406:)79 b(**)20 b(is)g(set)g(with)f(the)h
("find",)f("first")h(and)f("next")h(functions.)115 1320
y(407:)79 b(**)115 1359 y(408:)g(*/)115 1399 y(409:)g(FitsKw)20
b(insertBoolKw\(FitsKw,)e(char)i(*name,)f(Bool)h(value,)g(char)f
(*comment\);)115 1438 y(410:)79 b(FitsKw)20 b(insertIntKw\(FitsKw,)e
(char)i(*name,)f(int)h(value,)g(char)f(*comment\);)115
1478 y(411:)79 b(FitsKw)20 b(insertFloatKw\(FitsKw,)e(char)i(*name,)f
(float)h(value,)f(char)h(*comment\);)115 1517 y(412:)79
b(FitsKw)20 b(insertDoubleKw\(FitsKw,)e(char)i(*name,)f(double)h
(value,)f(char)h(*comment\);)115 1556 y(413:)79 b(FitsKw)20
b(insertStringKw\(FitsKw,)e(char)i(*name,)f(char)h(*)g(value,)f(char)h
(*comment\);)115 1596 y(414:)79 b(FitsKw)20 b(insertSpacesKw\(FitsKw,)e
(char)i(*comment\);)115 1635 y(415:)79 b(FitsKw)20 b
(insertCommentKw\(FitsKw,)e(char)i(*comment\);)115 1675
y(416:)79 b(FitsKw)20 b(insertHistoryKw\(FitsKw,)e(char)i(*comment\);)
115 1714 y(417:)115 1754 y(418:)79 b(/*)115 1793 y(419:)g(**)20
b(Adding)g(and)f(inserting)h(already)f(formatted)g(FITS)h(cards)f(to)h
(the)g(list)115 1832 y(420:)79 b(**)115 1872 y(421:)g(**)20
b(These)g(functions)f(take)h(an)f(already)h(formatted)f(FITS)h("card")f
(and)h(either)f(adds)115 1911 y(422:)79 b(**)20 b(the)g(string)f(to)h
(the)g(list)f(or)h(inserts)g(it)f(after)h(the)g(current)f(position.)39
b(If)115 1951 y(423:)79 b(**)20 b(the)g(string)f(is)h(less)g(than)f(80)
h(bytes)g(it)f(is)h(padded)g(with)f(spaces)h(to)g(80)f(bytes.)115
1990 y(424:)79 b(**)20 b(If)g(the)g(string)f(is)h(more)g(than)f(80)h
(bytes)f(it)h(is)g(truncated.)115 2030 y(425:)79 b(*/)115
2069 y(426:)g(int)20 b(addFitsCard\(Hdr)f(*,)h(char)f(*card\);)115
2108 y(427:)79 b(FitsKw)20 b(insertFitsCard\(FitsKw,)e(char)i(*card\);)
115 2148 y(428:)115 2187 y(429:)79 b(/*)115 2227 y(430:)g(**)20
b(Deleting)f(keywords)h(in)g(a)f(FITS)h(Header.)115 2266
y(431:)79 b(**)115 2306 y(432:)g(**)20 b(The)g("del")f(function)h(must)
f(be)h(preceeded)f(by)h(a)g("find")g(or)f("findnext")g(operation.)115
2345 y(433:)79 b(**)20 b(The)g("delAllKw")f(function)g(deletes)h(all)f
(keywords.)115 2385 y(434:)79 b(*/)115 2424 y(435:)g(void)20
b(delKw\(FitsKw\);)115 2463 y(436:)79 b(void)20 b(delAllKw\(Hdr)f(*\);)
115 2503 y(437:)115 2542 y(438:)79 b(/*)115 2582 y(439:)g(**)20
b(Low-level)f(I/O)h(Function)f(Declarations)115 2621
y(440:)79 b(*/)115 2661 y(441:)g(IODescPtr)20 b(openInputImage\(char)e
(*filename,)h(char)h(*extname,)f(int)h(extver\);)115
2700 y(442:)79 b(IODescPtr)20 b(openOutputImage\(char)e(*filename,)h
(char)h(*extname,)f(int)h(extver,)f(Hdr)h(*hdr,)998 2841
y Fc(7)p eop
%%Page: 8 8
8 7 bop 115 58 a Fd(443:)239 b(int)19 b(dim1,)h(int)g(dim2,)f
(FitsDataType)g(type\);)115 97 y(444:)79 b(IODescPtr)20
b(openUpdateImage\(char)e(*filename,)h(char)h(*extname,)f(int)h
(extver,)f(Hdr)h(*hdr\);)115 137 y(445:)79 b(void)20
b(closeImage\(IODescPtr)e(\);)115 176 y(446:)115 216
y(447:)79 b(char)20 b(*getFilename\(IODescPtr\);)115
255 y(448:)79 b(char)20 b(*getExtname\(IODescPtr\);)115
294 y(449:)79 b(int)20 b(getExtver\(IODescPtr\);)115
334 y(450:)79 b(int)20 b(getNaxis1\(IODescPtr\);)115
373 y(451:)79 b(int)20 b(getNaxis2\(IODescPtr\);)115
413 y(452:)79 b(int)20 b(getType\(IODescPtr\);)115 452
y(453:)115 492 y(454:)79 b(int)20 b(getHeader\(IODescPtr,)f(Hdr)g(*\);)
115 531 y(455:)79 b(int)20 b(putHeader\(IODescPtr\);)115
570 y(456:)115 610 y(457:)79 b(int)20 b(getFloatData\(IODescPtr,)e
(FloatTwoDArray)h(*\);)115 649 y(458:)79 b(int)20 b
(putFloatData\(IODescPtr,)e(FloatTwoDArray)h(*\);)115
689 y(459:)79 b(int)20 b(getShortData\(IODescPtr,)e(ShortTwoDArray)h
(*\);)115 728 y(460:)79 b(int)20 b(putShortData\(IODescPtr,)e
(ShortTwoDArray)h(*\);)115 768 y(461:)115 807 y(462:)79
b(int)20 b(getFloatLine\(IODescPtr,)e(int)i(line,)g(float)f(*\);)115
847 y(463:)79 b(int)20 b(putFloatLine\(IODescPtr,)e(int)i(line,)g
(float)f(*\);)115 886 y(464:)79 b(int)20 b(getShortLine\(IODescPtr,)e
(int)i(line,)g(short)f(*\);)115 925 y(465:)79 b(int)20
b(putShortLine\(IODescPtr,)e(int)i(line,)g(short)f(*\);)115
965 y(466:)115 1004 y(467:)79 b(int)20 b(getFloatSect\(IODescPtr,)e
(int)i(x_beg,)f(int)h(y_beg,)g(int)f(sx,)h(int)g(sy,)f(FloatTwoDArray)g
(*\);)115 1044 y(468:)79 b(int)20 b(putFloatSect\(IODescPtr,)e(int)i
(x_beg,)f(int)h(y_beg,)g(int)f(sx,)h(int)g(sy,)f(FloatTwoDArray)g(*\);)
115 1083 y(469:)79 b(int)20 b(getShortSect\(IODescPtr,)e(int)i(x_beg,)f
(int)h(y_beg,)g(int)f(sx,)h(int)g(sy,)f(ShortTwoDArray)g(*\);)115
1123 y(470:)79 b(int)20 b(putShortSect\(IODescPtr,)e(int)i(x_beg,)f
(int)h(y_beg,)g(int)f(sx,)h(int)g(sy,)f(ShortTwoDArray)g(*\);)115
1162 y(471:)115 1201 y(472:)79 b(/*)115 1241 y(473:)g(**)20
b(Initialization,)f(Allocation,)g(and)h(Freeing)f(Storage)h(Function)f
(Declarations)115 1280 y(474:)79 b(*/)115 1320 y(475:)g(#)20
b(define)g(IFloatData)f({)h(NULL,)f(0,)h(0,)g(0,)g(0,)f(0,)h(NULL)g(})
115 1359 y(476:)79 b(void)20 b(initFloatData\(FloatTwoDArray)e(*\);)115
1399 y(477:)79 b(int)20 b(allocFloatData\(FloatTwoDArray)e(*,)i(int,)f
(int\);)115 1438 y(478:)79 b(void)20 b(freeFloatData\(FloatTwoDArray)e
(*\);)115 1478 y(479:)79 b(#)20 b(define)g(IShortData)f({)h(NULL,)f(0,)
h(0,)g(0,)g(0,)f(0,)h(NULL)g(})115 1517 y(480:)79 b(void)20
b(initShortData\(ShortTwoDArray)e(*\);)115 1556 y(481:)79
b(int)20 b(allocShortData\(ShortTwoDArray)e(*,)i(int,)f(int\);)115
1596 y(482:)79 b(void)20 b(freeShortData\(ShortTwoDArray)e(*\);)115
1635 y(483:)79 b(#)20 b(define)g(IHdr)f({)h(0,)g(0,)g(NULL)f(})115
1675 y(484:)79 b(void)20 b(initHdr\(Hdr)f(*\);)115 1714
y(485:)79 b(int)20 b(allocHdr\(Hdr)f(*,)h(int\);)115
1754 y(486:)79 b(int)20 b(reallocHdr\(Hdr)f(*,)h(int\);)115
1793 y(487:)79 b(void)20 b(freeHdr\(Hdr)f(*\);)115 1832
y(488:)79 b(int)20 b(copyHdr\(Hdr)f(*to,)h(Hdr)g(*from\);)115
1872 y(489:)115 1911 y(490:)79 b(#)20 b(define)g(IFloatHdrData)f({)h
(NULL,)f({)h(0,)g(0,)f(0,)h(0)g(},)g(IHdr,)f(IFloatData)h(})115
1951 y(491:)79 b(void)20 b(initFloatHdrData\(FloatHdrData)e(*\);)115
1990 y(492:)79 b(int)20 b(allocFloatHdrData\(FloatHdrData)e(*,)i(int,)f
(int\);)115 2030 y(493:)79 b(void)20 b(freeFloatHdrData\(FloatHdrData)e
(*\);)115 2069 y(494:)79 b(#)20 b(define)g(IShortHdrData)f({)h(NULL,)f
({)h(0,)g(0,)f(0,)h(0)g(},)g(IHdr,)f(IShortData)h(})115
2108 y(495:)79 b(void)20 b(initShortHdrData\(ShortHdrData)e(*\);)115
2148 y(496:)79 b(int)20 b(allocShortHdrData\(ShortHdrData)e(*,)i(int,)f
(int\);)115 2187 y(497:)79 b(void)20 b(freeShortHdrData\(ShortHdrData)e
(*\);)115 2227 y(498:)115 2266 y(499:)79 b(#)20 b(define)g
(ISingleGroup)f({)h(NULL,)f(0,)h(NULL,)f(IFloatHdrData,)g
(IFloatHdrData,)g(\\)115 2306 y(500:)79 b(IShortHdrData)19
b(})115 2345 y(501:)79 b(void)20 b(initSingleGroup\(SingleGroup)e(*\);)
115 2385 y(502:)79 b(int)20 b(allocSingleGroup\(SingleGroup)e(*,)i
(int,)f(int\);)115 2424 y(503:)79 b(void)20 b
(freeSingleGroup\(SingleGroup)e(*\);)115 2463 y(504:)79
b(#)20 b(define)g(IMultiGroup)f({)h(0,)f(NULL)h(})115
2503 y(505:)79 b(void)20 b(initMultiGroup\(MultiGroup)e(*\);)115
2542 y(506:)79 b(int)20 b(allocMultiGroup\(MultiGroup)e(*,)i(int\);)115
2582 y(507:)79 b(void)20 b(freeMultiGroup\(MultiGroup)e(*\);)115
2621 y(508:)115 2661 y(509:)79 b(#)20 b(define)g(ISingleNicmosGroup)e
({)i(NULL,)g(0,)f(NULL,)h(IFloatHdrData,)f(IFloatHdrData,)g(\\)115
2700 y(510:)79 b(IShortHdrData,)19 b(IShortHdrData,)g(IFloatHdrData)g
(})998 2841 y Fc(8)p eop
%%Page: 9 9
9 8 bop 115 58 a Fd(511:)79 b(void)20 b
(initSingleNicmosGroup\(SingleNicmosGroup)d(*\);)115
97 y(512:)79 b(int)20 b(allocSingleNicmosGroup\(SingleNicmosGroup)d(*,)
j(int,)f(int\);)115 137 y(513:)79 b(void)20 b
(freeSingleNicmosGroup\(SingleNicmosGroup)d(*\);)115
176 y(514:)79 b(#)20 b(define)g(IMultiNicmosGroup)e({)i(0,)g(NULL)g(})
115 216 y(515:)79 b(void)20 b(initMultiNicmosGroup\(MultiNicmosGroup)d
(*\);)115 255 y(516:)79 b(int)20 b
(allocMultiNicmosGroup\(MultiNicmosGroup)d(*,)j(int\);)115
294 y(517:)79 b(void)20 b(freeMultiNicmosGroup\(MultiNicmosGroup)d
(*\);)115 334 y(518:)115 373 y(519:)79 b(#if)20 b
(defined\(__cplusplus\))115 413 y(520:)79 b(})115 452
y(521:)g(#)20 b(endif)115 492 y(522:)115 531 y(523:)79
b(#)20 b(endif)35 747 y Ff(2)89 b(Manipulating)18 b(FITS)h(Header)g(K)n
(eyw)o(ords)35 923 y Fb(2.1)73 b(Making)15 b(a)f(FITS)g(Header)115
1046 y Fd(328:)79 b(int)20 b(makePrimaryArrayHdr\(Hdr)e(*,)i
(FitsDataType,)f(int)h(dims,)f(int)h(*ndim\);)115 1086
y(329:)79 b(int)20 b(makeImageExtHdr\(Hdr)f(*,)g(FitsDataType,)g(int)h
(dims,)g(int)f(*ndim,)115 1125 y(330:)239 b(char)19 b(*extname,)h(int)f
(extver\);)35 1264 y Fc(These)i(routines)e(make)f(header)i(arrays)f
(with)g(the)g(minimal)f(set)i(of)f(FITS)g(ke)o(ywords.)38
b(The)o(y)20 b(return)f(0)g(is)35 1325 y(successful)13
b(and)g(-1)f(if)g(an)g(error)f(occurred.)35 1519 y Fb(2.2)73
b(Finding)15 b(k)o(eyw)o(ords)g(in)g(a)g(FITS)e(k)o(eyw)o(ord)j(list.)
115 1642 y Fd(347:)79 b(FitsKw)20 b(findKw\(Hdr)f(*,)h(char)f(*name\);)
115 1681 y(348:)79 b(FitsKw)20 b(findnextKw\(Hdr)f(*,)h(char)f
(*name\);)115 1720 y(349:)79 b(FitsKw)20 b(first\(Hdr)f(*\);)115
1760 y(350:)79 b(FitsKw)20 b(next\(FitsKw\);)115 1799
y(351:)79 b(FitsKw)20 b(getKw\(Hdr)f(*,)h(int)g(n\);)115
1839 y(352:)79 b(FitsKw)20 b(insertfirst\(Hdr)f(*\);)35
1978 y Fc(The)d(\252\256nd\272)g(function)e(starts)i(at)g(the)f(be)o
(ginning)g(of)h(the)f(list)h(and)f(\256nds)h(the)f(\256rst)g(occurence)
h(of)f(the)g(desired)35 2038 y(ke)o(yword.)30 b(The)17
b(\252\256ndne)o(xt\272)f(function)f(be)o(gins)i(at)g(the)f(current)g
(position)g(and)h(returns)e(the)i(ne)o(xt)f(occurence)35
2098 y(of)i(the)h(ke)o(yword.)36 b(NotF)o(ound)18 b(is)h(returned)e(if)
h(no)h(such)g(ke)o(yword)e(is)i(found.)36 b(The)19 b(\252\256rst\272)g
(function)f(sets)35 2159 y(the)d(current)f(position)g(to)g(the)h(be)o
(ginning)f(of)g(the)h(list.)25 b(The)15 b(\252ne)o(xt\272)g(function)f
(sets)h(the)g(position)f(to)h(the)f(ne)o(xt)35 2219 y(ke)o(yword)f(in)h
(the)g(list.)24 b(\252Ne)o(xt\272)14 b(returns)g(NotF)o(ound)f(after)h
(the)g(last)g(ke)o(yword)f(in)h(the)g(list.)24 b(\252GetKw\272)14
b(returns)35 2279 y(the)g(n-th)f(ke)o(yword.)20 b(The)14
b(special)g(function)f(\252insert\256rst\272)g(is)h(used)g(to)f
(position)h(the)f(cursor)g(prior)g(to)g(the)h(\256rst)35
2339 y(item)e(in)f(the)h(list)f(so)h(that)g(a)f(ne)o(w)h(ke)o(yword)e
(may)i(be)f(inserted)h(at)f(the)h(be)o(ginning)f(of)g(the)h(list.)18
b(\(Insert)11 b(functions)35 2399 y(always)h(insert)g(ke)o(ywords)g(at)
g(a)h(position)f(after)f(the)i(cursor)m(.\))35 2593 y
Fb(2.3)73 b(Accessing)13 b(and)i(changing)h(name,)f(v)o(alue,)g(or)f
(comment)i(in)f(a)f(FITS)g(k)o(eyw)o(ord.)115 2716 y
Fd(368:)79 b(char)20 b(*getKwName\(FitsKw\);)998 2841
y Fc(9)p eop
%%Page: 10 10
10 9 bop 115 58 a Fd(369:)79 b(char)20 b(*getKwComm\(FitsKw\);)115
97 y(370:)79 b(FitsDataType)19 b(getKwType\(FitsKw\);)115
137 y(371:)79 b(Bool)20 b(getBoolKw\(FitsKw\);)115 176
y(372:)79 b(int)40 b(getIntKw\(FitsKw\);)115 216 y(373:)79
b(float)20 b(getFloatKw\(FitsKw\);)115 255 y(374:)79
b(double)20 b(getDoubleKw\(FitsKw\);)115 294 y(375:)79
b(int)20 b(getStringKw\(FitsKw,)f(char)g(*str,)h(int)f(maxch\);)115
334 y(376:)79 b(int)20 b(putKwName\(FitsKw,)f(char)g(*name\);)115
373 y(377:)79 b(void)20 b(putKwComm\(FitsKw,)f(char)g(*comment\);)115
413 y(378:)79 b(int)20 b(putBoolKw\(FitsKw,)f(Bool)g(value\);)115
452 y(379:)79 b(int)20 b(putIntKw\(FitsKw,)f(int)h(value\);)115
492 y(380:)79 b(int)20 b(putFloatKw\(FitsKw,)f(float)g(value\);)115
531 y(381:)79 b(int)20 b(putDoubleKw\(FitsKw,)f(double)g(value\);)115
570 y(382:)79 b(int)20 b(putStringKw\(FitsKw,)f(char)g(*value\);)35
733 y Fc(These)f(functions)e(must)h(be)g(preceded)g(by)f(a)h
(\252\256nd\272)g(or)f(\252\256ndne)o(xt\272)h(operation.)31
b(Data)17 b(con)n(v)o(ersions)g(in)f(the)35 793 y(\252get\272)d
(routines:)198 956 y(FITS)f(T)l(ype)249 b(Possible)13
b(Requested)g(T)l(ype)198 1016 y(\320\320\320\320)262
b(\320\320\320\320\320\320\320\320\320\320)198 1076 y(Logical)310
b(Bool,)13 b(Int)198 1137 y(Int)406 b(Int,)12 b(Double)198
1197 y(Float)359 b(Float,)13 b(Double)198 1257 y(Double)315
b(Double)198 1317 y(String)339 b(String)35 1480 y(If)12
b(the)g(requested)h(type)f(con)n(v)o(ersion)g(is)h(not)f(allo)o(wed,)g
(an)h(error)e(code)h(is)h(set.)35 1677 y Fb(2.4)73 b(Adding)15
b(k)o(eyw)o(ords)g(to)g(a)g(FITS)f(Header)-6 b(.)115
1800 y Fd(393:)79 b(int)20 b(addBoolKw\(Hdr)f(*,)h(char)f(*name,)h
(Bool)g(value,)f(char)h(*comment\);)115 1839 y(394:)79
b(int)20 b(addIntKw\(Hdr)f(*,)h(char)g(*name,)f(int)h(value,)f(char)h
(*comment\);)115 1879 y(395:)79 b(int)20 b(addFloatKw\(Hdr)f(*,)h(char)
f(*name,)h(float)f(value,)h(char)g(*comment\);)115 1918
y(396:)79 b(int)20 b(addDoubleKw\(Hdr)f(*,)h(char)f(*name,)h(double)f
(value,)h(char)f(*comment\);)115 1958 y(397:)79 b(int)20
b(addStringKw\(Hdr)f(*,)h(char)f(*name,)h(char)f(*)h(value,)g(char)f
(*comment\);)115 1997 y(398:)79 b(int)20 b(addSpacesKw\(Hdr)f(*,)h
(char)f(*comment\);)115 2036 y(399:)79 b(int)20 b(addCommentKw\(Hdr)f
(*,)h(char)f(*comment\);)115 2076 y(400:)79 b(int)20
b(addHistoryKw\(Hdr)f(*,)h(char)f(*comment\);)35 2239
y Fc(The)13 b(ne)o(w)f(ke)o(ywords)g(are)g(added)g(to)h(the)f(ke)o
(yword)f(list)h(just)h(prior)e(to)h(the)h(\252END\272)g(ke)o(yword.)35
2436 y Fb(2.5)73 b(Inserting)14 b(k)o(eyw)o(ords)h(in)g(a)g(FITS)f
(Header)-6 b(.)115 2559 y Fd(409:)79 b(FitsKw)20 b
(insertBoolKw\(FitsKw,)e(char)i(*name,)f(Bool)h(value,)g(char)f
(*comment\);)115 2598 y(410:)79 b(FitsKw)20 b(insertIntKw\(FitsKw,)e
(char)i(*name,)f(int)h(value,)g(char)f(*comment\);)115
2637 y(411:)79 b(FitsKw)20 b(insertFloatKw\(FitsKw,)e(char)i(*name,)f
(float)h(value,)f(char)h(*comment\);)115 2677 y(412:)79
b(FitsKw)20 b(insertDoubleKw\(FitsKw,)e(char)i(*name,)f(double)h
(value,)f(char)h(*comment\);)115 2716 y(413:)79 b(FitsKw)20
b(insertStringKw\(FitsKw,)e(char)i(*name,)f(char)h(*)g(value,)f(char)h
(*comment\);)985 2841 y Fc(10)p eop
%%Page: 11 11
11 10 bop 115 58 a Fd(414:)79 b(FitsKw)20 b(insertSpacesKw\(FitsKw,)e
(char)i(*comment\);)115 97 y(415:)79 b(FitsKw)20 b
(insertCommentKw\(FitsKw,)e(char)i(*comment\);)115 137
y(416:)79 b(FitsKw)20 b(insertHistoryKw\(FitsKw,)e(char)i(*comment\);)
35 301 y Fc(The)12 b(ke)o(ywords)f(are)g(inserted)h(after)f(the)g
(current)g(position.)17 b(The)12 b(position)g(is)f(set)h(with)g(the)f
(\252\256nd\272,)h(\252\256rst\272)f(and)35 361 y(\252ne)o(xt\272)i
(functions.)35 558 y Fb(2.6)73 b(Adding/Inserting)15
b(alr)o(eady)g(f)o(ormatted)h(k)o(eyw)o(ords)115 681
y Fd(426:)79 b(int)20 b(addFitsCard\(Hdr)f(*,)h(char)f(*card\);)115
721 y(427:)79 b(FitsKw)20 b(insertFitsCard\(FitsKw,)e(char)i(*card\);)
35 885 y Fc(These)11 b(functions)e(take)g(an)h(already)f(formatted)f
(FITS)h("card")h(and)g(either)f(adds)h(the)f(string)h(to)f(the)h(list)f
(or)g(inserts)35 945 y(it)k(after)g(the)g(current)f(position.)20
b(If)12 b(the)h(string)g(is)g(less)h(than)f(80)g(bytes)h(it)e(is)i
(padded)f(with)g(spaces)h(to)f(80)g(bytes.)35 1005 y(If)f(the)g(string)
g(is)h(more)f(than)g(80)g(bytes)h(it)f(is)h(truncated.)35
1202 y Fb(2.7)73 b(Deleting)15 b(k)o(eyw)o(ords)g(in)g(a)g(FITS)e
(Header)-6 b(.)115 1325 y Fd(435:)79 b(void)20 b(delKw\(FitsKw\);)115
1365 y(436:)79 b(void)20 b(delAllKw\(Hdr)f(*\);)35 1529
y Fc(The)9 b(\252del\272)g(function)f(must)g(be)h(preceeded)f(by)h(a)g
(\252\256nd\272)f(or)g(\252\256ndne)o(xt\272)h(operation.)16
b(The)9 b(\252delAllKw\272)f(function)35 1589 y(deletes)13
b(all)f(ke)o(ywords.)35 1808 y Ff(3)89 b(Err)o(or)19
b(handling)f(in)f(hstio.c)35 1970 y Fc(I)f(ha)o(v)o(e)h(b)o(uilt)e(in)h
(some)h(de)o(gree)f(of)g(\257e)o(xibility)f(into)h(the)g(error)f
(handling.)29 b(The)17 b(routines)f(that)g(return)f(status)35
2030 y(information)c(return)g(0)i(if)f(successful)h(and)f(-1)g(for)g
(an)h(error)m(.)k(Y)-5 b(ou)12 b(can)h(access)g(further)e(error)h
(information)e(via)35 2090 y(the)j(functions:)354 2234
y Fd(HSTIOError)19 b(hstio_err\(\);)354 2273 y(char)h
(*hstio_errmsg\(\);)35 2437 y Fc(The)10 b(\256rst)f(merely)f(returns)g
(an)i(enumerated)e(code.)17 b(The)10 b(second)g(returns)e(a)h(te)o(xt)g
(string)g(with)g(the)g(error)f(message)35 2497 y(itself.)18
b(These)11 b(functions)f(can)h(be)g(e)o(xamined)g(after)f(an)o(y)g
(operation.)17 b(\252hstio)p Fa(_)p Fc(err\(\)\272)10
b(will)g(return)f(0)i(if)f(there)g(was)35 2557 y(no)j(error)m(.)35
2667 y(In)f(addition,)g(you)h(can)f(install)g(a)h(global)f(error)f
(handler)m(.)18 b(Suppose)13 b(you)f(ha)o(v)o(e)h(a)f(function)g(of)g
(the)g(form:)985 2841 y(11)p eop
%%Page: 12 12
12 11 bop 354 58 a Fd(void)20 b(detect_error\(\))f({)513
97 y(fprintf\(stderr,"There)g(was)h(an)f(ERROR!\\n\045s\\n",)673
137 y(hstio_errmsg\(\)\);)513 176 y(...)h(or)g(whatever)f(...)513
216 y(...)h(decide)g(what)f(to)h(do)g(...)354 255 y(})35
419 y Fc(Then,)14 b(you)e(can)g(install)h(this)f(function)f(as)i(a)g
(global)f(error)f(handler)h(with)g(the)g(function:)354
562 y Fd(push_hstioerr\(detect_error\);)35 726 y Fc(There)f(is)g(a)g
(stack)g(of)f(function)g(pointers)g(\(limited)f(to)i(a)f(nesting)h
(depth)f(of)g(32,)i(which)e(is)h(arbitrary\).)16 b(If)10
b(there)g(is)35 786 y(a)i(non-zero)e(pointer)g(on)h(the)g(stack,)h
(that)f(function)f(is)i(automatically)e(called)h(when)g(an)g(error)f
(occurs.)18 b(Y)-5 b(ou)10 b(are)35 847 y(free)j(to)g(do)g(an)o(ything)
g(in)g(the)h(error)e(handling)g(function:)19 b(print)13
b(a)g(message,)i(abort,)e(or)g(whate)o(v)o(er)m(.)21
b(Ex)o(ecution)35 907 y(continues)13 b(after)e(e)o(x)o(ecuting)i(the)f
(error)g(handling)f(function.)35 1017 y(Of)h(course,)h(there)f(is)h
(also)g(a)f(pop)g(function:)354 1160 y Fd(pop_hstioerr\(\);)35
1324 y Fc(So,)19 b(you)e(can)g(manipulate)g(the)g(error)f(handling)h
(stack)g(as)h(you)f(see)h(\256t,)g(e.)33 b(g.)g(by)17
b(installing)g(a)g(ne)o(w)g(error)35 1384 y(handling)i(function)f(at)h
(the)g(be)o(ginning)f(of)h(some)g(comple)o(x)g(procedure)f(and)h
(popping)f(it)h(at)g(the)f(end.)38 b(At)35 1444 y(an)o(y)15
b(point,)f(if)g(you)f(want)h(to)g(o)o(v)o(erride)f(the)h(action)g(of)g
(the)g(global)g(handler)f(and)h(gi)o(v)o(e)g(special)h(handling)e
(after)35 1504 y(e)o(x)o(ecuting)18 b(some)f(function,)h(you)e(can)i
(merely)e(push)h(0)g(onto)g(the)g(stack)g(before)f(e)o(x)o(ecuting)i
(the)f(operation.)35 1565 y(That)12 b(pre)o(v)o(ents)g(the)g(global)f
(error)g(handler)g(from)g(being)g(called.)19 b(Of)11
b(course,)h(the)g(pop)g(function)f(then)g(restores)35
1625 y(the)i(global)f(error)f(handler)m(.)35 1844 y Ff(4)89
b(IRAF)18 b(initialization)35 2006 y Fc(Y)-5 b(ou)15
b(don')o(t)g(ha)o(v)o(e)h(to)f(call)h(the)f(c)p Fa(_)p
Fc(ira\256nit)f(routine)h(an)o(ymore.)27 b(The)16 b(openXXImage)f
(routines)g(do)h(that.)27 b(Y)-5 b(ou)35 2066 y(still)13
b(can)f(call)g(c)p Fa(_)p Fc(ira\256nit)g(if)g(you)g(need)g(to)h(for)e
(other)h(reasons.)35 2286 y Ff(5)89 b(OpenOutputImage)35
2447 y Fc(If)21 b(the)h(openOutputImage\(\))e(routine)h(is)h(used)h(to)
e(write)h(a)g(primary)e(header)n(,)25 b(then)d(the)g(\256le)f
(designated)35 2508 y(by)e(the)g(\256lename)g(must)g(NO)n(T)g(already)g
(e)o(xist.)39 b(If)18 b(it)h(does)g(already)g(e)o(xist,)i(an)f(error)d
(is)j(returned.)37 b(If)18 b(the)35 2568 y(openOutputImage\(\))12
b(routine)g(is)i(used)f(to)g(write)g(an)g(e)o(xtension)h(image,)g(that)
f(HDU)g(is)h(appended)f(to)g(the)g(end)35 2628 y(of)f(the)h(\256le.)985
2841 y(12)p eop
%%Page: 13 13
13 12 bop 35 64 a Ff(6)89 b(OpenUpdateImage)35 226 y
Fc(If)15 b(the)h(openUpdateImage\(\))e(routine)h(is)i(used)f(the)g
(\256le)f(designated)h(by)g(the)g(\256lename)f(must)h(already)f(e)o
(xist.)35 286 y(The)e(HDU)g(number)e(associated)i(with)f(e)o(xtname)h
(and)f(e)o(xtv)o(er)h(is)f(read)h(and)f(then)g(re-written.)35
396 y(The)g(openUpdateImage\(\))e(routine)h(automatically)g(reads)g
(the)h(header)f(associated)h(with)f(the)h(image.)18 b(Y)-5
b(ou)10 b(do)35 456 y(not)i(ha)o(v)o(e)h(to)f(do)h(a)f(separate)h
(getHeader\(\).)35 676 y Ff(7)89 b(A)n(ppend)19 b(v)o(ersus)h(Ov)o
(erwrite)f(in)f(high-le)o(v)o(el)h(functions)35 837 y
Fc(In)9 b(general,)h(for)e(all)h(high-le)o(v)o(el)g(I/O)f(functions,)i
(if)f(the)g(option)f(parameter)h(is)g(0,)h(whate)o(v)o(er)f(HDUs)h(are)
f(in)n(v)o(olv)o(ed)35 898 y(are)k(either)e(written)h(to)g(a)h(ne)o
(wly)f(created)g(\256le)g(or)g(appended)h(to)f(the)g(end)h(of)f(an)g(e)
o(xisting)h(\256le.)18 b(In)12 b(other)g(words,)35 958
y(no)i(e)o(xisting)f(data)h(is)g(destroyed.)21 b(Ho)o(we)o(v)o(er)n(,)
13 b(if)g(the)h(option)e(parameter)h(is)h(Ov)o(erwrite,)f(whate)o(v)o
(er)h(HDUs)f(are)35 1018 y(in)n(v)o(olv)o(ed)f(o)o(v)o(erwrite)g(HDU)h
(number)e(e)o(xtv)o(er)m(.)35 1128 y(F)o(or)h(putSingleGroup:)198
1188 y(if)g(option)f(is)i(0,)g(e)o(xtv)o(er)f(is)h(ignored)348
1248 y(if)f(the)g(\256le)g(does)h(NO)n(T)g(e)o(xist)498
1308 y(the)f(global)g(header)g(is)h(written)f(and)498
1369 y(the)g(single)h(group)e(is)i(written)348 1429 y(else)g(if)f(the)g
(\256le)g(DOES)g(e)o(xist)498 1489 y(the)g(single)h(group)e(is)i
(appended)348 1549 y(endif)198 1609 y(else)g(if)f(option)f(is)i(Ov)o
(erwrite)348 1670 y(the)f(\256le)g(MUST)h(e)o(xist)348
1730 y(the)f(single)h(group)e(o)o(v)o(erwrites)h(HDU)h(number)e(e)o
(xtv)o(er)198 1790 y(endif)35 1900 y(F)o(or)h(putSingleGroupHdr:)198
1960 y(if)g(option)f(is)i(0)348 2020 y(the)f(\256le)g(must)h(NO)n(T)f
(e)o(xist)348 2081 y(the)g(primary)f(HDU)i(is)f(written)198
2141 y(else)h(if)f(option)f(is)i(Ov)o(erwrite)348 2201
y(the)f(\256le)g(MUST)h(e)o(xist)348 2261 y(the)f(primary)f(HDU)i(is)f
(o)o(v)o(erwritten)198 2321 y(endif)35 2541 y Ff(8)89
b(SingleGr)o(oup)18 b(and)h(MultiGr)o(oup)f(Structur)o(es)35
2703 y Fc(The)13 b(SingleGroup)e(and)i(MultiGroup)e(structures)h(ha)o
(v)o(e)h(been)f(changed.)19 b(The)o(y)13 b(are)f(no)o(w:)985
2841 y(13)p eop
%%Page: 14 14
14 13 bop 115 58 a Fd(219:)79 b(typedef)20 b(struct)f({)115
97 y(220:)239 b(char)19 b(*filename;)115 137 y(221:)239
b(int)19 b(group_num;)115 176 y(222:)239 b(Hdr)19 b(*globalhdr;)115
216 y(223:)239 b(SciHdrData)19 b(sci;)115 255 y(224:)239
b(ErrHdrData)19 b(err;)115 294 y(225:)239 b(DQHdrData)19
b(dq;)115 334 y(226:)79 b(})20 b(SingleGroup;)115 373
y(227:)115 413 y(228:)79 b(typedef)20 b(struct)f({)115
452 y(229:)239 b(char)19 b(*filename;)115 492 y(230:)239
b(int)19 b(group_num;)115 531 y(231:)239 b(Hdr)19 b(*globalhdr;)115
570 y(232:)239 b(SciHdrData)19 b(sci;)115 610 y(233:)239
b(ErrHdrData)19 b(err;)115 649 y(234:)239 b(DQHdrData)19
b(dq;)115 689 y(235:)239 b(SmplHdrData)19 b(smpl;)115
728 y(236:)239 b(IntgHdrData)19 b(intg;)115 768 y(237:)79
b(})20 b(SingleNicmosGroup;)35 931 y Fc(This)14 b(is)f(much)g(more)f
(con)n(v)o(enient)h(than)f(the)h(pre)o(vious)f(de\256nition)g(because)i
(it)e(makes)h(a)g(multi-group)e(merely)35 992 y(an)f(array)f(of)g
(single)g(groups.)18 b(Ho)o(we)o(v)o(er)n(,)9 b(this)h(complicates)g
(the)f(handling)g(of)g(the)h(global)f(header)m(.)17 b(F)o(ortunately)m
(,)35 1052 y(this)c(complication)e(is)i(completely)f(b)o(uried)g(in)g
(the)h(I/O)f(routines,)g(at)h(least)g(if)f(you)g(use)h(the)f(normal)g
(init-alloc-)35 1112 y(free)19 b(routines.)40 b(Here')m(s)19
b(what)h(those)f(routines)h(do.)39 b(The)20 b(SingleGroup)e(case)j(is)f
(fairly)e(easy)i(to)f(handle.)35 1172 y(InitSingleGroup)d(merely)h
(sets)i(the)f(pointer)f(globalhdr)g(to)g(NULL,)i(allocSingleGroup)e
(allocates)h(it,)h(and)35 1232 y(freeSingleGroup)12 b(frees)i(it.)22
b(F)o(or)13 b(a)h(multigroup,)f(group[0])f(contains)i(the)g(space)g
(for)f(the)h(actually)f(allocated)35 1293 y(\256lename)18
b(and)f(the)h(global)f(header)m(.)35 b(The)18 b(other)f(groups)g(in)h
(the)g(multi-group)d(merely)j(point)f(to)g(the)h(same)35
1353 y(allocated)e(space.)28 b(This)16 b(means)g(that)f(there)g(is)h
(only)f(one)g(global)g(header)g(and)h(one)f(\256lename,)i(so)e(it)h
(doesn')o(t)35 1413 y(matter)g(which)g(group)f(you)h(use)h(to)f(change)
h(things)f(in)g(the)g(global)g(header)m(.)30 b(The)16
b(freeMultiGroup)f(routine)35 1473 y(is)h(smart)g(enough)g(to)f(free)h
(only)f(group[0].)27 b(Neither)16 b(input)f(nor)h(output)f(ha)o(v)o(e)h
(to)g(be)g(changed;)h(e)o(v)o(erything)35 1533 y(should)c(work)e(just)h
(as)h(before.)35 1643 y(In)19 b(the)f(test)h(e)o(xamples,)j(output)c
(has)h(been)g(copied)g(from)e(input.)37 b(Handling)18
b(output)h(from)e(scratch,)k(i.)38 b(e.)35 1704 y(generating)13
b(it)h(from)e(completely)h(ne)o(w)h(data,)h(might)e(take)g(some)h(e)o
(xplanation.)22 b(Here')m(s)14 b(a)f(code)h(fragment)f(as)35
1764 y(an)h(e)o(xample.)23 b(Notice)14 b(that)f(the)h(indi)o(vidual)f
(groups)g(within)g(a)h(MultiGroup)f(do)h(not)f(ha)o(v)o(e)h(to)g(ha)o
(v)o(e)g(the)g(same)35 1824 y(dimensionality)m(.)195
1967 y Fd(SingleGroup)19 b(sg;)195 2006 y(MultiGroup)g(mg;)195
2085 y(initSingleGroup\(&sg\);)195 2125 y(initMultiGroup\(&mg\);)195
2204 y(allocSingleGroup\(&sg,128,128\);)195 2243 y(...)g(fill)h(the)g
(global)f(header)h(...)195 2283 y(...)f(fill)h(the)g(data)f(arrays)h
(...)195 2322 y(putSingleGroup\("filename",1,&sg,0\);)195
2361 y(freeSingleGroup\(&sg\);)195 2440 y(allocMultiGroup\(&mg,3\);)195
2480 y(allocSingleGroup\(&mg.group[0],128,128\);)195
2519 y(allocSingleGroup\(&mg.group[1],256,256\);)195
2559 y(allocSingleGroup\(&mg.group[2],512,512\);)195
2637 y(...)f(fill)h(the)g(global)f(header)h(...)195 2677
y(...)f(fill)h(data)g(group[0])f(...)195 2716 y(...)g(fill)h(data)g
(group[1])f(...)985 2841 y Fc(14)p eop
%%Page: 15 15
15 14 bop 195 58 a Fd(...)19 b(fill)h(data)g(group[2])f(...)195
137 y(for)g(\(k)h(=)g(0;)g(k)g(<)f(3;)h(++k\))274 176
y(putMultiGroup\("filename",\(k)e(+)i(1\),&mg,k,0\);)195
216 y(freeMultiGroup\(&mg\);)35 435 y Ff(9)71 b(Example)18
b(Pr)o(ograms)35 611 y Fb(9.1)58 b(Reading)15 b(an)g(Image)g(or)f
(Image)g(gr)o(oups)155 734 y Fd(1:)79 b(#)20 b(include)g(<hstio.h>)155
774 y(2:)79 b(#)20 b(include)g(<stdio.h>)155 813 y(3:)155
852 y(4:)79 b(void)20 b(showHdr\(Hdr)f(*h,)h(char)f(*title\))h({)155
892 y(5:)239 b(int)19 b(i;)155 931 y(6:)239 b(printf\("\045s:)19
b(number)g(of)h(lines:)g(\045d\\n",title,)f(h->nlines\);)155
971 y(7:)239 b(if)20 b(\(h->array)f(!=)h(NULL\))155 1010
y(8:)398 b(for)20 b(\(i)g(=)g(0;)f(i)h(<)g(h->nlines;)f(++i\))155
1050 y(9:)558 b(printf\("\045s\\n",h->array[i]\);)135
1089 y(10:)239 b(printf\("\\n"\);)135 1128 y(11:)79 b(})135
1168 y(12:)135 1207 y(13:)g(void)20 b(showFloatData\(FloatTwoDArray)e
(*x,)i(char)f(*title\))h({)135 1247 y(14:)239 b(int)19
b(i;)135 1286 y(15:)239 b(printf\("\045s:\\n",title\);)135
1326 y(16:)135 1365 y(17:)g(printf\("\(\045d,)19 b(0\))h(\045g)f
(",0,PPix\(x,0,0\)\);)135 1405 y(18:)279 b(for)19 b(\(i)h(=)g(1;)g(i)g
(<)f(5;)h(++i\))g(printf\("\045g)f(",PPix\(x,i,0\)\);)135
1444 y(19:)279 b(printf\(")19 b(...)h("\);)135 1483 y(20:)239
b(printf\("\(\045d,)19 b(0\))h(\045g)f(",\(x->nx)h(-)g
(5\),PPix\(x,\(x->nx)e(-)i(5\),0\)\);)135 1523 y(21:)279
b(for)19 b(\(i)h(=)g(x->nx)g(-)f(4;)h(i)g(<)g(x->nx;)f(++i\))h
(printf\("\045g)f(",PPix\(x,i,0\)\);)135 1562 y(22:)279
b(printf\("\\n"\);)135 1602 y(23:)135 1641 y(24:)239
b(printf\("\(\045d,)19 b(1\))h(\045g)f(",0,PPix\(x,0,1\)\);)135
1681 y(25:)279 b(for)19 b(\(i)h(=)g(1;)g(i)g(<)f(5;)h(++i\))g
(printf\("\045g)f(",PPix\(x,i,1\)\);)135 1720 y(26:)279
b(printf\(")19 b(...)h("\);)135 1759 y(27:)239 b(printf\("\(\045d,)19
b(1\))h(\045g)f(",\(x->nx)h(-)g(5\),PPix\(x,\(x->nx)e(-)i(5\),1\)\);)
135 1799 y(28:)279 b(for)19 b(\(i)h(=)g(x->nx)g(-)f(4;)h(i)g(<)g
(x->nx;)f(++i\))h(printf\("\045g)f(",PPix\(x,i,1\)\);)135
1838 y(29:)279 b(printf\("\\n"\);)135 1878 y(30:)135
1917 y(31:)239 b(printf\("\(\045d,)19 b(max)h(-)f(2\))h(\045g)g
(",0,PPix\(x,0,x->ny)f(-)g(2\)\);)135 1957 y(32:)279
b(for)19 b(\(i)h(=)g(1;)g(i)g(<)f(5;)h(++i\))g(printf\("\045g)f
(",PPix\(x,i,x->ny)g(-)h(2\)\);)135 1996 y(33:)279 b(printf\(")19
b(...)h("\);)135 2036 y(34:)239 b(printf\("\(\045d,)19
b(max)h(-)f(2\))h(\045g)g(",\(x->nx)f(-)h(5\),PPix\(x,\(x->nx)f(-)h
(5\),x->ny)f(-)h(2\)\);)135 2075 y(35:)279 b(for)19 b(\(i)h(=)g(x->nx)g
(-)f(4;)h(i)g(<)g(x->nx;)f(++i\))h(printf\("\045g)f(",PPix\(x,i,x->ny)g
(-)h(2\)\);)135 2114 y(36:)279 b(printf\("\\n"\);)135
2154 y(37:)135 2193 y(38:)239 b(printf\("\(\045d,)19
b(max)h(-)f(1\))h(\045g)g(",0,PPix\(x,0,x->ny)f(-)g(1\)\);)135
2233 y(39:)279 b(for)19 b(\(i)h(=)g(1;)g(i)g(<)f(5;)h(++i\))g
(printf\("\045g)f(",PPix\(x,i,x->ny)g(-)h(1\)\);)135
2272 y(40:)279 b(printf\(")19 b(...)h("\);)135 2312 y(41:)239
b(printf\("\(\045d,)19 b(max)h(-)f(1\))h(\045g)g(",\(x->nx)f(-)h
(5\),PPix\(x,\(x->nx)f(-)h(5\),x->ny)f(-)h(1\)\);)135
2351 y(42:)279 b(for)19 b(\(i)h(=)g(x->nx)g(-)f(4;)h(i)g(<)g(x->nx;)f
(++i\))h(printf\("\045g)f(",PPix\(x,i,x->ny)g(-)h(1\)\);)135
2390 y(43:)279 b(printf\("\\n"\);)135 2430 y(44:)239
b(printf\("\\n"\);)135 2469 y(45:)79 b(})135 2509 y(46:)135
2548 y(47:)g(void)20 b(showShortData\(ShortTwoDArray)e(*x,)i(char)f
(*title\))h({)135 2588 y(48:)239 b(int)19 b(i;)135 2627
y(49:)239 b(printf\("\045s:\\n",title\);)135 2666 y(50:)135
2706 y(51:)g(printf\("\(\045d,)19 b(0\))h(\045d)f(",0,PPix\(x,0,0\)\);)
985 2841 y Fc(15)p eop
%%Page: 16 16
16 15 bop 135 58 a Fd(52:)279 b(for)19 b(\(i)h(=)g(1;)g(i)g(<)f(5;)h
(++i\))g(printf\("\045d)f(",PPix\(x,i,0\)\);)135 97 y(53:)279
b(printf\(")19 b(...)h("\);)135 137 y(54:)239 b(printf\("\(\045d,)19
b(0\))h(\045d)f(",\(x->nx)h(-)g(5\),PPix\(x,\(x->nx)e(-)i(5\),0\)\);)
135 176 y(55:)279 b(for)19 b(\(i)h(=)g(x->nx)g(-)f(4;)h(i)g(<)g(x->nx;)
f(++i\))h(printf\("\045d)f(",PPix\(x,i,0\)\);)135 216
y(56:)279 b(printf\("\\n"\);)135 255 y(57:)135 294 y(58:)239
b(printf\("\(\045d,)19 b(1\))h(\045d)f(",0,PPix\(x,0,1\)\);)135
334 y(59:)279 b(for)19 b(\(i)h(=)g(1;)g(i)g(<)f(5;)h(++i\))g
(printf\("\045d)f(",PPix\(x,i,1\)\);)135 373 y(60:)279
b(printf\(")19 b(...)h("\);)135 413 y(61:)239 b(printf\("\(\045d,)19
b(1\))h(\045d)f(",\(x->nx)h(-)g(5\),PPix\(x,\(x->nx)e(-)i(5\),1\)\);)
135 452 y(62:)279 b(for)19 b(\(i)h(=)g(x->nx)g(-)f(4;)h(i)g(<)g(x->nx;)
f(++i\))h(printf\("\045d)f(",PPix\(x,i,1\)\);)135 492
y(63:)279 b(printf\("\\n"\);)135 531 y(64:)135 570 y(65:)239
b(printf\("\(\045d,)19 b(max)h(-)f(2\))h(\045d)g(",0,PPix\(x,0,x->ny)f
(-)g(2\)\);)135 610 y(66:)279 b(for)19 b(\(i)h(=)g(1;)g(i)g(<)f(5;)h
(++i\))g(printf\("\045d)f(",PPix\(x,i,x->ny)g(-)h(2\)\);)135
649 y(67:)279 b(printf\(")19 b(...)h("\);)135 689 y(68:)239
b(printf\("\(\045d,)19 b(max)h(-)f(2\))h(\045d)g(",\(x->nx)f(-)h
(5\),PPix\(x,\(x->nx)f(-)h(5\),x->ny)f(-)h(2\)\);)135
728 y(69:)279 b(for)19 b(\(i)h(=)g(x->nx)g(-)f(4;)h(i)g(<)g(x->nx;)f
(++i\))h(printf\("\045d)f(",PPix\(x,i,x->ny)g(-)h(2\)\);)135
768 y(70:)279 b(printf\("\\n"\);)135 807 y(71:)135 847
y(72:)239 b(printf\("\(\045d,)19 b(max)h(-)f(1\))h(\045d)g
(",0,PPix\(x,0,x->ny)f(-)g(1\)\);)135 886 y(73:)279 b(for)19
b(\(i)h(=)g(1;)g(i)g(<)f(5;)h(++i\))g(printf\("\045d)f
(",PPix\(x,i,x->ny)g(-)h(1\)\);)135 925 y(74:)279 b(printf\(")19
b(...)h("\);)135 965 y(75:)239 b(printf\("\(\045d,)19
b(max)h(-)f(1\))h(\045d)g(",\(x->nx)f(-)h(5\),PPix\(x,\(x->nx)f(-)h
(5\),x->ny)f(-)h(1\)\);)135 1004 y(76:)279 b(for)19 b(\(i)h(=)g(x->nx)g
(-)f(4;)h(i)g(<)g(x->nx;)f(++i\))h(printf\("\045d)f(",PPix\(x,i,x->ny)g
(-)h(1\)\);)135 1044 y(77:)279 b(printf\("\\n"\);)135
1083 y(78:)239 b(printf\("\\n"\);)135 1123 y(79:)79 b(})135
1162 y(80:)135 1201 y(81:)g(void)20 b(show_iodesc\(IODescPtr)e(x\))i({)
135 1241 y(82:)239 b(printf\("IODesc:)19 b(filename)g(=)h(\045s)g
(extname)f(=)h(\045s)g(extver)f(=)h(\045d\\n\\tnaxis1)f(=)h(\045d)g(\\)
135 1280 y(83:)79 b(naxis2)20 b(=)g(\045d)f(data)h(type)g(=)g
(\045d\\n",)f(getFilename\(x\),)g(getExtname\(x\),)g(getExtver\(x\),)
135 1320 y(84:)398 b(getNaxis1\(x\),)19 b(getNaxis2\(x\),)g
(getType\(x\)\);)135 1359 y(85:)79 b(})135 1399 y(86:)135
1438 y(87:)g(void)20 b(detect_err\(\))f({)135 1478 y(88:)239
b(printf\("HSTIO)19 b(Error)g(\(\045d\):)h
(\045s\\n",hstio_err\(\),hstio_errmsg\(\)\);)135 1517
y(89:)239 b(exit\(0\);)135 1556 y(90:)79 b(})135 1596
y(91:)135 1635 y(92:)g(int)20 b(main\(int)f(argc,)h(char)g(**argv\))f
({)135 1675 y(93:)239 b(IODescPtr)19 b(pri,)h(sci,)f(dq,)h(err;)135
1714 y(94:)79 b(#ifdef)20 b(EX3)135 1754 y(95:)239 b(IODescPtr)19
b(outpri,)g(outsci,)h(outdq,)f(outerr;)135 1793 y(96:)79
b(#endif)135 1832 y(97:)135 1872 y(98:)239 b(Hdr)19 b(prihdr,)h
(scihdr,)f(dqhdr,)h(errhdr;)135 1911 y(99:)239 b(FloatTwoDArray)19
b(scidata;)115 1951 y(100:)239 b(ShortTwoDArray)19 b(dqdata;)115
1990 y(101:)239 b(FloatTwoDArray)19 b(errdata;)115 2030
y(102:)239 b(int)19 b(i;)115 2069 y(103:)239 b(char)19
b(*tmp;)115 2108 y(104:)115 2148 y(105:)239 b(SciHdrData)19
b(scihdrdata;)115 2187 y(106:)239 b(DQHdrData)39 b(dqhdrdata;)115
2227 y(107:)239 b(ErrHdrData)19 b(errhdrdata;)115 2266
y(108:)239 b(SingleGroup)19 b(sg;)115 2306 y(109:)239
b(MultiGroup)19 b(mg;)115 2345 y(110:)115 2385 y(111:)239
b(int)19 b(A)h(=)g(1;)g(/*)g(low-level)f(routines)g(*/)115
2424 y(112:)239 b(int)19 b(B)h(=)g(3;)g(/*)g(high-level)f(XXHdrData)g
(routines)h(*/)115 2463 y(113:)239 b(int)19 b(C)h(=)g(4;)g(/*)g
(high-level)f(SingleGroup)g(*/)115 2503 y(114:)239 b(int)19
b(D)h(=)g(5;)g(/*)g(high-level)f(MultiGroup)g(*/)115
2542 y(115:)115 2582 y(116:)239 b(/*)115 2621 y(117:)g(**)20
b(Command)f(line)h(arguments:)115 2661 y(118:)239 b(**)119
b(1.)20 b(input)g(file)f(name)115 2700 y(119:)239 b(**)119
b(2.)20 b(output)f(file)h(name)985 2841 y Fc(16)p eop
%%Page: 17 17
17 16 bop 115 58 a Fd(120:)239 b(*/)115 97 y(121:)79
b(#ifdef)20 b(EX3)115 137 y(122:)239 b(if)20 b(\(argc)f(!=)h(3\))g({)
115 176 y(123:)398 b(printf\("Wrong)19 b(number)h(of)f(input)h
(arguments:)f(ex3)h(input)f(output\\n"\);)115 216 y(124:)398
b(exit\(0\);)115 255 y(125:)239 b(})115 294 y(126:)g
(printf\("Executing)18 b(program)i(ex3)g(--)f(test)h(of)g(pipeline)f
(I/O)h(routines\\n"\);)115 334 y(127:)239 b(printf\("Input:)19
b(input)g(file)h(reading)f(6)h(groups)g(of)f(Sci,)h(Err,)g(DQ.\\n"\);)
115 373 y(128:)239 b(printf\("Output:)19 b(output)g(file)h(creating)f
(6)h(groups)f(of)h(Sci,)g(Err,)f(DQ.\\n"\);)115 413 y(129:)79
b(#else)115 452 y(130:)239 b(if)20 b(\(argc)f(!=)h(2\))g({)115
492 y(131:)398 b(printf\("Wrong)19 b(number)h(of)f(input)h(arguments:)f
(ex2)h(input\\n"\);)115 531 y(132:)398 b(exit\(0\);)115
570 y(133:)239 b(})115 610 y(134:)g(printf\("Executing)18
b(program)i(ex2)g(--)f(test)h(of)g(pipeline)f(I/O)h(routines\\n"\);)115
649 y(135:)239 b(printf\("Input:)19 b(input)g(file)h(reading)f(6)h
(groups)g(of)f(Sci,)h(Err,)g(DQ.\\n"\);)115 689 y(136:)79
b(#endif)115 728 y(137:)115 768 y(138:)239 b(/*)20 b(install)f(the)h
(error)f(handler)h(*/)115 807 y(139:)239 b
(push_hstioerr\(detect_err\);)115 847 y(140:)115 886
y(141:)g(/*)115 925 y(142:)g(**)20 b(Initialize)f(the)g(data)h
(structures.)115 965 y(143:)239 b(*/)115 1004 y(144:)g
(initFloatData\(&scidata\);)115 1044 y(145:)g
(initShortData\(&dqdata\);)115 1083 y(146:)g
(initFloatData\(&errdata\);)115 1123 y(147:)g(initHdr\(&prihdr\);)115
1162 y(148:)g(initHdr\(&scihdr\);)115 1201 y(149:)g(initHdr\(&dqhdr\);)
115 1241 y(150:)g(initHdr\(&errhdr\);)115 1280 y(151:)115
1320 y(152:)g(initFloatHdrData\(&scihdrdata\);)115 1359
y(153:)g(initShortHdrData\(&dqhdrdata\);)115 1399 y(154:)g
(initFloatHdrData\(&errhdrdata\);)115 1438 y(155:)g
(initSingleGroup\(&sg\);)115 1478 y(156:)g(initMultiGroup\(&mg\);)115
1517 y(157:)115 1556 y(158:)g(/*)115 1596 y(159:)g(**)20
b(First,)f(we)h(will)f(use)h(the)g(low-level)f(I/O)h(routines)f(to)h
(open)115 1635 y(160:)239 b(**)20 b(and)f(read)h(the)g(primary)f
(header,)g(and)h(the)g(first)f(three)115 1675 y(161:)239
b(**)20 b(extension)f(image)g(arrays.)115 1714 y(162:)239
b(*/)115 1754 y(163:)g(printf\("\\n=======)18 b(Primary)i(header:)f
(read)h(=========\\n"\);)115 1793 y(164:)239 b(pri)19
b(=)h(openInputImage\(argv[1],"",0\);)115 1832 y(165:)239
b(getHeader\(pri,&prihdr\);)115 1872 y(166:)g(show_iodesc\(pri\);)115
1911 y(167:)g(showHdr\(&prihdr,"Primary)18 b(Header)h(Keywords"\);)115
1951 y(168:)239 b(printf\("=======)19 b(Primary)g(header:)g(read)h
(complete)f(=========\\n"\);)115 1990 y(169:)79 b(#ifdef)20
b(EX3)115 2030 y(170:)239 b(outpri)19 b(=)h
(openOutputImage\(argv[2],"",0,&prihdr,)d(0,)j(0,)g(0\);)115
2069 y(171:)239 b(closeImage\(outpri\);)115 2108 y(172:)79
b(#endif)115 2148 y(173:)239 b(closeImage\(pri\);)115
2187 y(174:)g(freeHdr\(&prihdr\);)115 2227 y(175:)115
2266 y(176:)159 b(for)20 b(\(i)g(=)f(A;)h(i)g(<=)g(A)g(+)g(1;)f(++i\))h
({)115 2306 y(177:)239 b(printf\("\\n=======)18 b(Science)i(data:)f
(read)h(=========\\n"\);)115 2345 y(178:)239 b(sci)19
b(=)h(openInputImage\(argv[1],"SCI",i\);)115 2385 y(179:)239
b(getHeader\(sci,&scihdr\);)115 2424 y(180:)g(show_iodesc\(sci\);)115
2463 y(181:)g(showHdr\(&scihdr,"Science)18 b(Header)h(Keywords"\);)115
2503 y(182:)239 b(getFloatData\(sci,&scidata\);)115 2542
y(183:)g(showFloatData\(&scidata,"Selected)17 b(Science)j(Data"\);)115
2582 y(184:)239 b(printf\("=======)19 b(Science)g(data:)h(read)f
(complete)h(=========\\n"\);)115 2621 y(185:)79 b(#ifdef)20
b(EX3)115 2661 y(186:)239 b(outsci)19 b(=)h
(openOutputImage\(argv[2],"sci",i,&scihdr,)115 2700 y(187:)398
b(getNaxis1\(sci\),)19 b(getNaxis2\(sci\),0\);)985 2841
y Fc(17)p eop
%%Page: 18 18
18 17 bop 115 58 a Fd(188:)239 b(putFloatData\(outsci,&scidata\);)115
97 y(189:)g(closeImage\(outsci\);)115 137 y(190:)79 b(#endif)115
176 y(191:)239 b(closeImage\(sci\);)115 216 y(192:)g
(freeFloatData\(&scidata\);)115 255 y(193:)g(freeHdr\(&scihdr\);)115
294 y(194:)115 334 y(195:)g(printf\("\\n=======)18 b(Error)i(data:)g
(read)f(=========\\n"\);)115 373 y(196:)239 b(err)19
b(=)h(openInputImage\(argv[1],"ERR",i\);)115 413 y(197:)239
b(getHeader\(err,&errhdr\);)115 452 y(198:)g(showHdr\(&errhdr,"Error)18
b(Header)i(Keywords"\);)115 492 y(199:)239 b
(getFloatData\(err,&errdata\);)115 531 y(200:)g(show_iodesc\(err\);)115
570 y(201:)g(showFloatData\(&errdata,"Selected)17 b(Error)j(Data"\);)
115 610 y(202:)239 b(printf\("=======)19 b(Error)g(data:)h(read)f
(complete)h(=========\\n"\);)115 649 y(203:)79 b(#ifdef)20
b(EX3)115 689 y(204:)239 b(outerr)19 b(=)h
(openOutputImage\(argv[2],"err",i,&errhdr,)115 728 y(205:)398
b(errdata.nx,)19 b(errdata.ny,0\);)115 768 y(206:)239
b(putFloatData\(outerr,&errdata\);)115 807 y(207:)g
(closeImage\(outerr\);)115 847 y(208:)79 b(#endif)115
886 y(209:)239 b(closeImage\(err\);)115 925 y(210:)g
(freeFloatData\(&errdata\);)115 965 y(211:)g(freeHdr\(&errhdr\);)115
1004 y(212:)115 1044 y(213:)g(printf\("\\n=======)18
b(Data)i(Quality)f(data:)h(read)g(=========\\n"\);)115
1083 y(214:)239 b(dq)20 b(=)f(openInputImage\(argv[1],"DQ",i\);)115
1123 y(215:)239 b(getHeader\(dq,&dqhdr\);)115 1162 y(216:)g
(showHdr\(&dqhdr,"Data)18 b(Quality)i(Header)f(Keywords"\);)115
1201 y(217:)239 b(getShortData\(dq,&dqdata\);)115 1241
y(218:)g(show_iodesc\(dq\);)115 1280 y(219:)g
(showShortData\(&dqdata,"Selected)17 b(Data)j(Quality)f(Data"\);)115
1320 y(220:)239 b(printf\("\\n=======)18 b(Data)i(Quality)f(data:)h
(read)g(complete)f(=========\\n"\);)115 1359 y(221:)79
b(#ifdef)20 b(EX3)115 1399 y(222:)239 b(outdq)19 b(=)h
(openOutputImage\(argv[2],"dq",i,&dqhdr,)115 1438 y(223:)398
b(dqdata.nx,)19 b(dqdata.ny,0\);)115 1478 y(224:)239
b(putShortData\(outdq,&dqdata\);)115 1517 y(225:)g
(closeImage\(outdq\);)115 1556 y(226:)79 b(#endif)115
1596 y(227:)239 b(closeImage\(dq\);)115 1635 y(228:)g
(freeShortData\(&dqdata\);)115 1675 y(229:)g(freeHdr\(&dqhdr\);)115
1714 y(230:)115 1754 y(231:)159 b(})115 1793 y(232:)115
1832 y(233:)239 b(/*)115 1872 y(234:)g(**)20 b(Now,)f(we)h(will)g(test)
f(the)h(high-level)f(routines.)115 1911 y(235:)239 b(**)20
b(First,)f(test)h(getSci,)f(getErr,)g(and)h(getDQ.)115
1951 y(236:)239 b(*/)115 1990 y(237:)g(printf\("\\n=======)18
b(Science)i(data:)f(read)h(=========\\n"\);)115 2030
y(238:)239 b(getSci\(argv[1],B,&scihdrdata\);)115 2069
y(239:)g(show_iodesc\(scihdrdata.iodesc\);)115 2108 y(240:)g
(showHdr\(&scihdrdata.hdr,"Science)17 b(Header)j(Keywords"\);)115
2148 y(241:)239 b(showFloatData\(&scihdrdata.data,"Science)17
b(Data"\);)115 2187 y(242:)239 b(printf\("=======)19
b(Science)g(data:)h(read)f(complete)h(=========\\n"\);)115
2227 y(243:)79 b(#ifdef)20 b(EX3)115 2266 y(244:)239
b(putSci\(argv[2],B,&scihdrdata,0\);)115 2306 y(245:)79
b(#endif)115 2345 y(246:)239 b(freeFloatHdrData\(&scihdrdata\);)115
2385 y(247:)115 2424 y(248:)g(printf\("\\n=======)18
b(Error)i(data:)g(read)f(=========\\n"\);)115 2463 y(249:)239
b(getErr\(argv[1],B,&errhdrdata\);)115 2503 y(250:)g
(show_iodesc\(errhdrdata.iodesc\);)115 2542 y(251:)g
(showHdr\(&errhdrdata.hdr,"Error)17 b(Header)j(Keywords"\);)115
2582 y(252:)239 b(showFloatData\(&errhdrdata.data,"Error)17
b(Data"\);)115 2621 y(253:)239 b(printf\("=======)19
b(Error)g(data:)h(read)f(complete)h(=========\\n"\);)115
2661 y(254:)79 b(#ifdef)20 b(EX3)115 2700 y(255:)239
b(putErr\(argv[2],B,&errhdrdata,0\);)985 2841 y Fc(18)p
eop
%%Page: 19 19
19 18 bop 115 58 a Fd(256:)79 b(#endif)115 97 y(257:)239
b(freeFloatHdrData\(&errhdrdata\);)115 137 y(258:)115
176 y(259:)g(printf\("\\n=======)18 b(Data)i(Quality)f(data:)h(read)g
(=========\\n"\);)115 216 y(260:)239 b(getDQ\(argv[1],B,&dqhdrdata\);)
115 255 y(261:)g(show_iodesc\(dqhdrdata.iodesc\);)115
294 y(262:)g(showHdr\(&dqhdrdata.hdr,"DQ)18 b(Header)h(Keywords"\);)115
334 y(263:)239 b(showShortData\(&dqhdrdata.data,"Data)17
b(Quality)j(Data"\);)115 373 y(264:)239 b(printf\("=======)19
b(Data)g(Quality)h(data:)f(read)h(complete)f(=========\\n"\);)115
413 y(265:)79 b(#ifdef)20 b(EX3)115 452 y(266:)239 b
(putDQ\(argv[2],B,&dqhdrdata,0\);)115 492 y(267:)79 b(#endif)115
531 y(268:)239 b(freeShortHdrData\(&dqhdrdata\);)115
570 y(269:)115 610 y(270:)g(/*)115 649 y(271:)g(**)20
b(Now,)f(test)h(getSingleGroup.)115 689 y(272:)239 b(*/)115
728 y(273:)g(printf\("\\n=======)18 b(Single)i(group)f(data:)h(read)g
(=========\\n"\);)115 768 y(274:)239 b
(getSingleGroup\(argv[1],C,&sg\);)115 807 y(275:)g(printf\("Filename:)
18 b(\045s)i(group)g(\045d\\n",sg.filename,sg.group_num\);)115
847 y(276:)239 b(showHdr\(sg.globalhdr,"Global)18 b(header"\);)115
886 y(277:)239 b(showHdr\(&sg.sci.hdr,"Science)18 b(Header)h
(Keywords"\);)115 925 y(278:)239 b
(showFloatData\(&sg.sci.data,"Science)17 b(Data"\);)115
965 y(279:)239 b(showHdr\(&sg.err.hdr,"Error)18 b(Header)h
(Keywords"\);)115 1004 y(280:)239 b(showFloatData\(&sg.err.data,)18
b("Error)h(Data"\);)115 1044 y(281:)239 b(showHdr\(&sg.dq.hdr,"DQ)18
b(Header)i(Keywords"\);)115 1083 y(282:)239 b
(showShortData\(&sg.dq.data,)18 b("Data)h(Quality)h(Data"\);)115
1123 y(283:)239 b(printf\("=======)19 b(Single)g(group)h(data:)f(read)h
(complete)f(=========\\n"\);)115 1162 y(284:)79 b(#ifdef)20
b(EX3)115 1201 y(285:)239 b(putSingleGroup\(argv[2],C,&sg,0\);)115
1241 y(286:)79 b(#endif)115 1280 y(287:)239 b(freeSingleGroup\(&sg\);)
115 1320 y(288:)115 1359 y(289:)g(/*)115 1399 y(290:)g(**)20
b(Finally,)f(test)h(getMultiGroup.)115 1438 y(291:)239
b(*/)115 1478 y(292:)g(printf\("\\n=======)18 b(Multiple)i(group)f
(data:)h(read)g(=========\\n"\);)115 1517 y(293:)239
b(allocMultiGroup\(&mg,4\);)115 1556 y(294:)g
(getMultiGroupHdr\(argv[1],&mg\);)115 1596 y(295:)g(for)19
b(\(i)h(=)g(0;)g(i)g(<)g(2;)f(++i\))115 1635 y(296:)318
b({)20 b(getMultiGroup\(&mg,i,\(i)f(+)g(D\)\);)h(})115
1675 y(297:)239 b(printf\("Filename:)18 b
(\045s\\n",mg.group[0].filename\);)115 1714 y(298:)239
b(showHdr\(mg.group[0].globalhdr,"Global)17 b(header"\);)115
1754 y(299:)239 b(for)19 b(\(i)h(=)g(0;)g(i)g(<)g(2;)f(++i\))h({)115
1793 y(300:)318 b(showHdr\(&mg.group[i].sci.hdr,"Science)18
b(Header)h(Keywords"\);)115 1832 y(301:)318 b
(showFloatData\(&mg.group[i].sci.data,"Science)17 b(Data"\);)115
1872 y(302:)318 b(showHdr\(&mg.group[i].err.hdr,"Error)18
b(Header)h(Keywords"\);)115 1911 y(303:)318 b
(showFloatData\(&mg.group[i].err.data,"Error)17 b(Data"\);)115
1951 y(304:)318 b(showHdr\(&mg.group[i].dq.hdr,"DQ)18
b(Header)i(Keywords"\);)115 1990 y(305:)318 b
(showShortData\(&mg.group[i].dq.data,"Data)17 b(Quality)j(Data"\);)115
2030 y(306:)239 b(})115 2069 y(307:)g(printf\("=======)19
b(Multi)g(group)h(data:)f(read)h(complete)f(=========\\n"\);)115
2108 y(308:)79 b(#ifdef)20 b(EX3)115 2148 y(309:)239
b(for)19 b(\(i)h(=)g(0;)g(i)g(<)g(2;)f(++i\))115 2187
y(310:)318 b(putMultiGroup\(argv[2],\(i)19 b(+)g(D\),&mg,i,0\);)115
2227 y(311:)79 b(#endif)115 2266 y(312:)239 b(freeMultiGroup\(&mg\);)
115 2306 y(313:)115 2345 y(314:)g(return)19 b(0;)115
2385 y(315:)79 b(})115 2424 y(316:)985 2841 y Fc(19)p
eop
%%Page: 20 20
20 19 bop 35 58 a Fb(9.2)58 b(Illustration)16 b(of)e(Lo)o(w-Le)o(v)o
(el)i(I/O)e(Routines)155 181 y Fd(1:)79 b(#)20 b(include)g(<hstio.h>)
155 220 y(2:)79 b(#)20 b(include)g(<stdio.h>)155 260
y(3:)155 299 y(4:)79 b
(/****************************************************)o(*************)
o(**********)155 338 y(5:)155 378 y(6:)239 b(Illustration)19
b(of)h(the)f(low-level)h(I/O)f(routines)155 417 y(7:)558
b(using)155 457 y(8:)239 b(Data)19 b(Structures)h(and)f(I/O)h(Function)
f(Declarations)g(for)155 496 y(9:)239 b(STScI)19 b(Calibration)g
(Pipeline)h(Software)f(for)h(STIS)f(and)h(NICMOS)135
536 y(10:)135 575 y(11:)79 b(Input)20 b(data)g(structures,)f(such)g(as)
h(FloatTwoDArray)f(and)h(Hdr,)f(each)h(have)135 614 y(12:)79
b(initilization,)19 b(allocation,)g(and)h(free)g(routines:)f
(initFloatData,)135 654 y(13:)79 b(allocFloatData,)19
b(freeFloatData.)135 693 y(14:)135 733 y(15:)79 b(On)20
b(input,)g(if)f(the)h(data)g(structures)f(already)g(have)h(storage)f
(allocated)h(and)f(that)135 772 y(16:)79 b(storage)20
b(is)g(the)f(same)h(size)g(as)f(the)h(requested)f(data,)h(that)f(data)h
(storage)f(is)135 812 y(17:)79 b(reused.)40 b(If)19 b(it)h(is)g(not)g
(the)f(same)h(size,)g(the)f(old)h(storage)f(is)h(freed)g(and)f(new)135
851 y(18:)79 b(storage)20 b(is)g(allocated.)39 b(If)19
b(storage)h(has)g(not)f(been)h(allocated,)f(then)h(the)f(input)135
891 y(19:)79 b(routines)20 b(allocate)f(it.)135 930 y(20:)135
969 y(21:)79 b(It)20 b(is)g(the)g(responsibility)f(of)g(the)h
(application)f(program)h(to)f(free)h(the)135 1009 y(22:)79
b(allocated)20 b(storage.)135 1048 y(23:)135 1088 y(24:)79
b(*****************************************************)o
(*************)o(*********/)135 1127 y(25:)135 1167 y(26:)g(void)20
b(detect_err\(\))f({)135 1206 y(27:)239 b(printf\("HSTIO)19
b(Error)g(\(\045d\):)h(\045s\\n",hstio_err\(\),hstio_errmsg\(\)\);)135
1245 y(28:)239 b(exit\(0\);)135 1285 y(29:)79 b(})135
1324 y(30:)135 1364 y(31:)g(int)20 b(main\(int)f(argc,)h(char)g
(**argv\))f({)135 1403 y(32:)239 b(IODescPtr)19 b(in;)135
1443 y(33:)239 b(FloatTwoDArray)19 b(x)h(=)f(IFloatData;)135
1482 y(34:)239 b(Hdr)19 b(h)h(=)g(IHdr;)135 1522 y(35:)239
b(IODescPtr)19 b(out;)135 1561 y(36:)239 b(FloatTwoDArray)19
b(z)h(=)f(IFloatData;)135 1600 y(37:)239 b(int)19 b(i,)h(j;)135
1640 y(38:)135 1679 y(39:)239 b(/*)20 b(install)f(the)h(error)f
(handler)h(*/)135 1719 y(40:)239 b(push_hstioerr\(detect_err\);)135
1758 y(41:)135 1798 y(42:)g(initFloatData\(&x\);)18 b(/*)i(Initialize)f
(the)h(data)g(structures.)39 b(Failure)19 b(to)h(*/)135
1837 y(43:)239 b(initFloatData\(&z\);)18 b(/*)i(initilize)f(the)h(data)
g(structures)f(increases)g(the)h(*/)135 1876 y(44:)239
b(initHdr\(&h\);)99 b(/*)19 b(probablilty)g(of)h(getting)g(a)f(core)h
(dump.)179 b(*/)135 1916 y(45:)135 1955 y(46:)239 b(/*)20
b(This)f(section)h(illustrates)f(the)g(input)h(case.)g(*/)135
1995 y(47:)239 b(in)20 b(=)f(openInputImage\("infile.fit","",0\);)135
2034 y(48:)239 b(getFloatData\(in,&x\);)135 2074 y(49:)g
(getHeader\(in,&h\);)135 2113 y(50:)g(closeImage\(in\);)135
2152 y(51:)g(for)19 b(\(j)h(=)g(x.ny)g(-)g(1;)f(j)h(>=)g(0;)g(--j\))f
({)140 b(/*)20 b(Do)f(something)h(with)79 b(*/)135 2192
y(52:)318 b(for)20 b(\(i)g(=)g(0;)g(i)f(<)h(x.nx;)g(++i\))199
b(/*)20 b(the)f(data,)239 b(*/)135 2231 y(53:)398 b(printf\("\045g)19
b(",)h(Pix\(x,i,j\)\);)135 2271 y(54:)318 b(printf\("\\n"\);)135
2310 y(55:)239 b(})135 2350 y(56:)g(for)19 b(\(i)h(=)g(0;)g(i)g(<)g
(h.nlines;)f(++i\))199 b(/*)20 b(and)f(the)h(header.)119
b(*/)135 2389 y(57:)398 b(printf\("\045s\\n",)19 b(h.array[i]\);)135
2429 y(58:)239 b(freeFloatData\(&x\);)437 b(/*)20 b(The)f(application)g
(must)h(*/)135 2468 y(59:)239 b(freeHdr\(&h\);)557 b(/*)20
b(free)f(storage.)159 b(*/)135 2507 y(60:)135 2547 y(61:)239
b(/*)20 b(This)f(section)h(illustrates)f(the)g(output)h(case.)f(*/)135
2586 y(62:)239 b(allocFloatData\(&z,5,5\);)337 b(/*)20
b(Storage)f(must)h(be)119 b(*/)135 2626 y(63:)239 b(allocHdr\(&h,25\);)
477 b(/*)20 b(allocated.)218 b(*/)135 2665 y(64:)239
b(for)19 b(\(j)h(=)g(z.ny)g(-)g(1;)f(j)h(>=)g(0;)g(--j\))179
b(/*)20 b(Fill)f(the)h(data)g(array)39 b(*/)135 2705
y(65:)318 b(for)20 b(\(i)g(=)g(0;)g(i)f(<)h(z.nx;)g(++i\))985
2841 y Fc(20)p eop
%%Page: 21 21
21 20 bop 135 58 a Fd(66:)398 b(Pix\(z,i,j\))19 b(=)h(\(i)g(+)g(1\))g
(*)f(1000.0)h(+)g(j)g(+)g(1;)135 97 y(67:)239 b(/*)20
b(And,)f(also)h(fill)f(the)h(header)g(array)f(*/)135
137 y(68:)239 b(addFloatKw\(&h,"CRVAL1",1.5,")18 b("\);)135
176 y(69:)239 b(addFloatKw\(&h,"CRVAL2",2.5,")18 b("\);)135
216 y(70:)239 b(addFloatKw\(&h,"CRPIX1",3.5,")18 b("\);)135
255 y(71:)239 b(addFloatKw\(&h,"CRPIX2",4.5,")18 b("\);)135
294 y(72:)239 b(addFloatKw\(&h,"CD1_1",5.5,")18 b("\);)135
334 y(73:)239 b(addFloatKw\(&h,"CD1_2",6.5,")18 b("\);)135
373 y(74:)239 b(addFloatKw\(&h,"CD2_1",7.5,")18 b("\);)135
413 y(75:)239 b(addFloatKw\(&h,"CD2_2",8.5,")18 b("\);)135
452 y(76:)239 b(addIntKw\(&h,"TEST1",34,")18 b("\);)135
492 y(77:)239 b(addBoolKw\(&h,"TEST2",True,")18 b("\);)135
531 y(78:)135 570 y(79:)239 b(out)19 b(=)h
(openOutputImage\("outfile1.fit","sci",0,&h,5,5,0\);)135
610 y(80:)239 b(/*)20 b(the)f(openOutputImage)g(routine)g(writes)h(the)
g(header)f(*/)135 649 y(81:)239 b(putFloatData\(out,&z\);)377
b(/*)20 b(write)f(the)h(data.)119 b(*/)135 689 y(82:)239
b(closeImage\(out\);)135 728 y(83:)g(freeFloatData\(&z\);)437
b(/*)20 b(Then,)f(free)h(the)139 b(*/)135 768 y(84:)239
b(freeHdr\(&h\);)557 b(/*)20 b(storage.)258 b(*/)135
807 y(85:)135 847 y(86:)239 b(/*)20 b(This)f(section)h(illustrates)f
(copying)g(data)h(from)f(one)h(file)g(to)f(another)h(*/)135
886 y(87:)239 b(in)20 b(=)f(openInputImage\("infile.fit","sci",0\);)135
925 y(88:)239 b(getHeader\(in,&h\);)135 965 y(89:)g
(getFloatData\(in,&x\);)135 1004 y(90:)g(closeImage\(in\);)135
1044 y(91:)g(out)19 b(=)h(openOutputImage\("outfile2.fit","sci",0,&h,)
135 1083 y(92:)398 b(getNaxis1\(in\),getNaxis2\(in\),0\);)135
1123 y(93:)239 b(putFloatData\(out,&x\);)135 1162 y(94:)g
(closeImage\(out\);)135 1201 y(95:)g(freeFloatData\(&x\);)135
1241 y(96:)g(freeHdr\(&h\);)135 1280 y(97:)135 1320 y(98:)g(return)19
b(0;)135 1359 y(99:)79 b(})115 1399 y(100:)985 2841 y
Fc(21)p eop
%%Trailer
end
userdict /end-hook known{end-hook}if
%%EOF
