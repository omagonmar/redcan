#$Header: /home/pros/xray/RCS/mkpkg,v 11.2 2003/02/06 21:01:48 prosb Exp $
#$Log: mkpkg,v $
#Revision 11.2  2003/02/06 21:01:48  prosb
#added macosx to mkpkg
#
#Revision 11.1  1998/05/05 18:52:08  prosb
#added freebsd & redhat for linux.
#
#Revision 11.0  1997/11/06 16:46:35  prosb
#General Release 2.5
#
#Revision 9.3  1997/11/05 19:49:09  prosb
#JCC (11/5/97) - Remove <crt> at line DIRS for alpha.
#                This fix was included in 2.5 release.
#
#Revision 9.2  1997/10/08 21:38:15  prosb
#JCC(10/8/97) - add configuration for LINUX; comment out xlocal for
#               the release pros2.5.
#
#Revision 9.1  1997/05/09 18:41:30  prosb
#added alpha architecture and commented out "xlocan & xobsolete" for
#a release 2.5.  (Wendy/JCC)
#
#Revision 9.0  1995/11/16  18:24:16  prosb
#General Release 2.4
#
#Revision 8.4  1995/06/22  18:27:26  wendy
#corrected typo in ssun architecture line
#
#Revision 8.3  1995/06/21  20:07:29  wendy
#added ssun architecture
#
#Revision 8.2  1995/03/10  15:46:49  wendy
#changed the package compile order since xspatial/eintools
#needs the xdataio/eincdrom/libgentab.a.
#
#Revision 8.1  1994/09/07  17:45:31  janet
#jd - uncommented xlocal package that is commented out for a release.
#
#Revision 8.0  94/06/27  13:41:11  prosb
#General Release 2.3.1
#
#Revision 7.1  94/06/17  17:59:43  wendy
#commented out xlocal for release
#added f2c architecture for Mac installations
#
#Revision 7.0  93/12/27  18:50:12  prosb
#General Release 2.3
#
#Revision 6.1  93/06/29  12:13:44  wendy
#Added other architectures (ddec, dmip, rs6000, mips, irix).
#
#Revision 6.0  93/05/24  15:35:01  prosb
#General Release 2.2
#
#Revision 5.0  92/10/29  22:39:01  prosb
#General Release 2.1
#
#Revision 4.1  92/10/23  09:50:52  mo
#MC	10/24/92	Add xlocal to compile
#
#Revision 4.0  92/04/27  14:05:46  prosb
#General Release 2.0:  April 1992
#
#Revision 2.3  92/04/24  16:58:39  prosb
#Commented xlocal out of update for release.
#
#Revision 2.2  92/02/26  15:07:08  mo
#Mc	Jan 	Add the xobsolete and xlocal to the mkpkg
#
#Revision 2.1  91/08/01  22:06:33  mo
#MC	8/1/91		Release version without xlocal and xobsolete
#
#Revision 2.0  91/03/07  02:11:04  pros
#General Release 1.0
#
# Make the PROS X-ray astronomy packages.

$ifeq (hostid, unix)  !(date)  $endif
$call update
$ifeq (hostid, unix)  !(date)  $endif
$exit

update:
# NOTE: xspatial must be compiled after xdataio, since xspatial/eintools
#       depends on the library file xdataio/eincdrom/libgentab.a.
	$call lib
	$call ximages
	$call xspectral
	$call xtiming
	$call xdataio
	$call xspatial
	$call xplot
	$call xproto
#       $call xobsolete
	$call xraytasks	
#       $call xlocal
	$ifeq (HOSTID, vms) $purge [...] $endif
	$purge bin$
	;

lib:
	$echo "--------------------- LIB --------------------"
	$call update@lib
	;

ximages:
	$echo "--------------------- XIMAGES --------------------"
	$call update@ximages
	;

xraytasks:
	$echo "--------------------- XRAYTASKS --------------------"
	$call update@xraytasks
	;

xspatial:
	$echo "--------------------- XSPATIAL --------------------"
	$call update@xspatial
	;

xspectral:
	$echo "--------------------- XSPECTRAL --------------------"
	$call update@xspectral
	;

xdataio:
	$echo "--------------------- XDATAIO --------------------"
	$call update@xdataio
	;

xplot:
	$echo "--------------------- XPLOT  --------------------"
	$call update@xplot
	;

xtiming:
	$echo "--------------------- XTIMING ----------------------"
	$call update@xtiming
	;


xlocal:
	$echo "--------------------- XLOCAL ----------------------"
	$call update@xlocal
	;

xproto:
	$echo "--------------------- XPROTO ----------------------"
	$call update@xproto
	;

xobsolete:
	$echo "--------------------- XOBSOLETE ----------------------"
	$call update@xobsolete
	;


# STRIP -- Strip the XRAY directories of all sources and other files not
# required to run the system, or for user programming.

strip:
	!rmfiles -f lib/strip.xray
	;

# SUMMARY -- [UNIX] mkpkg summary: output a summary of the spooled mkpkg
# output, omitting most of the mundane chatter.  Used to scan large spool
# files for errors.

summary:
	$ifeq (HOSTID, unix)
	    ! grep -v ':$$' spool | grep -v '^xc' | grep -v '^ar'\
	    | grep -v '^check file'
	$else
	    $echo "mkpkg summary only available on a UNIX system"
	$endif
	;

# SUN/IRAF multiple architecture support.
# ----------------------------------------

showfloat:				# show current float option
	$verbose off
	!$(hlib)/mkfloat.csh
	;
generic:				# make architecture indep. (no bins)
	$verbose off
	$set DIRS = "lib xdataio xproto ximages xspatial xspectral xtiming xraytasks xplot"
	!$(hlib)/mkfloat.csh generic -d $(DIRS)
	;
sparc:					# install sparc binaries
	$verbose off
	$set DIRS = "lib xdataio xproto ximages xspatial xspectral xtiming xraytasks xplot"
#	$set DIRS = "lib einstein misc nimages rosat spatial spectral timing xray"
	!$(hlib)/mkfloat.csh sparc -d $(DIRS)
	;
ssun:                                   # install ssun (Solaris) binaries
        $verbose off
        $set DIRS = "lib xdataio xproto ximages xspatial xspectral xtiming xraytasks xplot"
        !$(hlib)/mkfloat.csh ssun -d $(DIRS)       
	;
i386:					# install i386 binaries
	$verbose off
	$set DIRS = "lib xdataio xproto ximages xspatial xspectral xtiming xraytasks xplot"
#	$set DIRS = "lib einstein misc nimages rosat spatial spectral timing xray"
	!$(hlib)/mkfloat.csh i386 -d $(DIRS)
	;
f68881:					# install f68881 binaries
	$verbose off
	$set DIRS = "lib xdataio xproto ximages xspatial xspectral xtiming xraytasks xplot"
#	$set DIRS = "lib einstein misc nimages rosat spatial spectral timing xray"
	#  Make sure the output bin directory is writeable.
#	!chmod +w $(xray)/bin.f68881
	!$(hlib)/mkfloat.csh f68881 -d $(DIRS)
	;
ffpa:					# install ffpa binaries
	$verbose off
	$set DIRS = "lib xdataio xproto ximages xspatial xspectral xtiming xraytasks xplot"
#	$set DIRS = "lib einstein misc nimages rosat spatial spectral timing xray"

	!$(hlib)/mkfloat.csh ffpa -d $(DIRS)
	;
fswitch:				# install fswitch binaries
	$verbose off
	$set DIRS = "lib xdataio xproto ximages xspatial xspectral xtiming xraytasks xplot"
#	$set DIRS = "lib einstein misc nimages rosat spatial spectral timing xray"
	!$(hlib)/mkfloat.csh fswitch -d $(DIRS)
	;
fsoft:					# install fsoft binaries
	$verbose off
	$set DIRS = "lib xdataio xproto ximages xspatial xspectral xtiming xraytasks xplot"
#	$set DIRS = "lib einstein misc nimages rosat spatial spectral timing xray"
	!$(hlib)/mkfloat.csh fsoft -d $(DIRS)
	;
pg:					# install -pg -f68881 binaries
	$verbose off
	$set DIRS = "lib xdataio xproto ximages xspatial xspectral xtiming xraytasks xplot"
#	$set DIRS = "lib einstein misc nimages rosat spatial spectral timing xray"
	!$(hlib)/mkfloat.csh pg -d $(DIRS)
	;
freebsd:                                  # install freebsd binaries
        $verbose off
        $set DIRS = "lib xdataio xproto ximages xspatial xspectral xtiming xraytasks xplot"
        !$(hlib)/mkfloat.csh freebsd -d $(DIRS)
        ;
redhat:                                  # install redhat binaries
        $verbose off
        $set DIRS = "lib xdataio xproto ximages xspatial xspectral xtiming xraytasks xplot"
        !$(hlib)/mkfloat.csh redhat -d $(DIRS)
        ;
macosx:                                  # install macosx binaries
        $verbose off
        $set DIRS = "lib xdataio xproto ximages xspatial xspectral xtiming xraytasks xplot"
        !$(hlib)/mkfloat.csh macosx -d $(DIRS)
        ;
linux:                                  # install linux binaries
        $verbose off
        $set DIRS = "lib xdataio xproto ximages xspatial xspectral xtiming xraytasks xplot"
        !$(hlib)/mkfloat.csh linux -d $(DIRS)
        ;
alpha:                                  # install DEC Alpha/OSF binaries
        $verbose off
        $set DIRS = "lib xdataio xproto ximages xspatial xspectral xtiming xraytasks xplot"
        !$(hlib)/mkfloat.csh alpha -d $(DIRS)
        ;
ddec:					# install DSUX DEC Fortran binaries 
	$verbose off
	$set DIRS = "lib xdataio xproto ximages xspatial xspectral xtiming xraytasks xplot"
#	$set DIRS = "lib einstein misc nimages rosat spatial spectral timing xray"
	!$(hlib)/mkfloat.csh ddec -d $(DIRS)
	;
dmip:					# install DSUX MIPS Fortran binaries 
	$verbose off
	$set DIRS = "lib xdataio xproto ximages xspatial xspectral xtiming xraytasks xplot"
#	$set DIRS = "lib einstein misc nimages rosat spatial spectral timing xray"
	!$(hlib)/mkfloat.csh dmip -d $(DIRS)
	;
rs6000:					# install rs6000 binaries 
	$verbose off
	$set DIRS = "lib xdataio xproto ximages xspatial xspectral xtiming xraytasks xplot"
#	$set DIRS = "lib einstein misc nimages rosat spatial spectral timing xray"
	!$(hlib)/mkfloat.csh rs6000 -d $(DIRS)
	;
mips:					# install mips binaries 
	$verbose off
	$set DIRS = "lib xdataio xproto ximages xspatial xspectral xtiming xraytasks xplot"
#	$set DIRS = "lib einstein misc nimages rosat spatial spectral timing xray"
	!$(hlib)/mkfloat.csh mips -d $(DIRS)
	;
irix:					# install irix binaries 
	$verbose off
	$set DIRS = "lib xdataio xproto ximages xspatial xspectral xtiming xraytasks xplot"
#	$set DIRS = "lib einstein misc nimages rosat spatial spectral timing xray"
	!$(hlib)/mkfloat.csh irix -d $(DIRS)
	;
f2c:					# install architectures without Fortran
        $verbose off
        $set DIRS = "lib pkg"
        !$(hlib)/mkfloat.csh f2c -d $(DIRS)
        ;
vaxtar:
	!echo "use xtar instead"
	;
